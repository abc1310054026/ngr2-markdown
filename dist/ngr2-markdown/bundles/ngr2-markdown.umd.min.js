!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("markdown-it/lib/index"),require("highlight.js"),require("rxjs"),require("@angular/core"),require("@angular/platform-browser")):"function"==typeof define&&define.amd?define("ngr2-markdown",["exports","markdown-it/lib/index","highlight.js","rxjs","@angular/core","@angular/platform-browser"],t):t(e["ngr2-markdown"]={},e.MarkdownIt,e.hljs,e.rxjs,e.ng.core,e.ng.platformBrowser)}(this,function(e,t,r,n,i,o){"use strict";var a=function(){function e(){var i=this;this.unitMap={exist:!1,child:{b:{exist:!1,child:{v:{exist:!0,child:{}}}},c:{exist:!1,child:{i:{exist:!0,child:{}},p:{exist:!0,child:{}}}},h:{exist:!1,child:{c:{exist:!0,child:{}},l:{exist:!0,child:{r:{exist:!0,child:{}}}},v:{exist:!0,child:{}}}},i:{exist:!1,child:{v:{exist:!0,child:{}}}},m:{exist:!1,child:{e:{exist:!0,child:{r:{exist:!0,child:{}}}},m:{exist:!0,child:{}},c:{exist:!0,child:{}}}},n:{exist:!1,child:{i:{exist:!0,child:{m:{exist:!1,child:{v:{exist:!0,child:{}}}}}}}},p:{exist:!1,child:{a:{exist:!1,child:{c:{exist:!0,child:{}}}}}},q:{exist:!0,child:{}},t:{exist:!1,child:{p:{exist:!0,child:{}}}},w:{exist:!1,child:{v:{exist:!0,child:{}}}},x:{exist:!1,child:{a:{exist:!1,child:{m:{exist:!1,child:{v:{exist:!0,child:{}}}}}},e:{exist:!0,child:{}},p:{exist:!0,child:{}}}}}},this.currentHeading=new n.BehaviorSubject(null),this.TOCInfo=new n.BehaviorSubject(null),this.MarkdownIt=new t({highlight:function(e,t){if(t&&r.getLanguage(t))try{return'<pre class="hljs"><code>'+r.highlight(t,e).value+"</code></pre>"}catch(n){}return'<pre class="hljs"><code>'+i.MarkdownIt.utils.escapeHtml(e)+"</code>"}}),this.MarkdownIt.use(this.anchor,function(e){return i.TOCInfo.next(e)})}return e.prototype.toggle=function(e){e.anchor?this.MarkdownIt.enable("anchor"):this.MarkdownIt.disable("anchor"),e.TOC?this.MarkdownIt.enable("anchor"):this.MarkdownIt.disable("anchor")},e.prototype.render=function(e){return"string"!=typeof e&&(e=""),this.MarkdownIt.render(e)},e.prototype.anchor=function(e,r){var o=new l("root",0);e.core.ruler.push("anchor",function(e){var i=new Array;e.tokens.map(function(e,t,n){"heading_open"===e.type&&(e.attrJoin("id",n[t+1].content),i.push(new l(e.attrGet("id"),e.markup.length)))});for(var t=o=new l("root",0),n=0;n<i.length;n++){for(;t&&t.indentLevel>=i[n].indentLevel;)t=t.parent;(i[n].parent=t).children.push(i[n]),t=i[n]}r(o)})},e.prototype.setCurrentHeading=function(e){this.currentHeading.getValue()!==e&&this.currentHeading.next(e)},e.prototype.checkUnit=function(e,t,n){if(e&&t){var i;n||(t=t.toLocaleLowerCase());var r=!1;for(i=t.length-1;0<=i;i--){var o=t.charCodeAt(i);if(48<=o&&o<=57){r=e.exist;break}if(!e.child[t[i]])break;e=e.child[t[i]]}return r?{unit:t.substr(i+1),number:Number.parseInt(t.substr(0,i+1),10)}:null}},e.decorators=[{type:i.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[]},e.ngInjectableDef=i.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}(),s=function m(){},l=function f(e,t){this.content=e,this.indentLevel=t,this.children=new Array};function c(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,r,o=n.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(i=o.next()).done;)a.push(i.value)}catch(s){r={error:s}}finally{try{i&&!i.done&&(n=o["return"])&&n.call(o)}finally{if(r)throw r.error}}return a}var d=function(){function e(e){this.markdownService=e,this.bodyClassName="markdown-body",this.height="800px",this.themeColor="#3f51b5"}return Object.defineProperty(e.prototype,"markdown",{set:function(e){var t=this;this._html=this.markdownService.render(e),this.reinitialization(),setTimeout(function(){t.updateHeadingInfo()})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"options",{set:function(e){this._options=e,this.markdownService.toggle(this._options)},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){},e.prototype.reinitialization=function(){this.headingElementMarginTop={},this.headingElementRef=new Array,this.markdownBody.nativeElement.scrollTop=0,this.markdownService.setCurrentHeading(null)},e.prototype.markdownScroll=function(){var n=this;if(!(this.headingElementRef===undefined||null===this.headingElementRef||this.headingElementRef.length<=0)){var i,r,o,a,s=this.markdownBody.nativeElement.getBoundingClientRect().top,e=this.headingElementRef.reduce(function(e,t){return i=e.getBoundingClientRect(),r=t.getBoundingClientRect(),o=n.headingElementMarginTop[e.id],a=n.headingElementMarginTop[t.id],0<r.top-s-a?e:r.top-s-a>i.top-s-o?t:e});this.markdownService.setCurrentHeading(e.id)}},e.prototype.updateHeadingInfo=function(){var e,n=this,t=this.markdownBody.nativeElement.querySelectorAll("h1, h2, h3, h4, h5, h6");t!==undefined&&null!==t&&(this.headingElementRef.splice(0),t.forEach(function(e){var t=n.getComputedStyle(e,"margin-top");t.slice(0,t.length-2),n.headingElementMarginTop[e.id]=Number.parseInt(t,10)}),(e=this.headingElementRef).push.apply(e,function i(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(c(arguments[t]));return e}(t)))},e.prototype.getComputedStyle=function(e,t,n){return window.getComputedStyle(e,null).getPropertyValue(t)},e.decorators=[{type:i.Component,args:[{selector:"nb-ngr2-markdown",template:'<div class="markdown-container"\n     [style.height]="height"\n>\n  <nb-side-toc class="side-anchor-container"\n               *ngIf="_options.TOC"\n  >\n  </nb-side-toc>\n  <div style="flex: 3;"\n       [ngClass]="[bodyClassName]"\n       #markdownBody\n       [innerHTML]="_html | hTMLPipe"\n       (scroll)="markdownScroll()"\n  >\n  </div>\n</div>\n',encapsulation:i.ViewEncapsulation.None,styles:[".markdown-body{overflow-y:auto;box-sizing:border-box;margin:0 auto;padding:45px;min-width:200px;height:100%}@media (max-width:767px){.markdown-body{padding:15px}}.markdown-container{position:relative;display:flex;align-items:flex-start;flex:1 auto}.side-anchor-container{flex:0 0 200px}"]}]}],e.ctorParameters=function(){return[{type:a}]},e.propDecorators={markdownBody:[{type:i.ViewChild,args:["markdownBody",{read:i.ElementRef}]}],markdown:[{type:i.Input}],options:[{type:i.Input}],bodyClassName:[{type:i.Input}],height:[{type:i.Input}],themeColor:[{type:i.Input}]},e}(),h=function(){function e(e){this.markdownService=e,this.themeColor="#3f51b5"}return e.prototype.ngOnInit=function(){var t=this;this.markdownService.currentHeading.subscribe({next:function(e){t.currentHeading=e}}),this.markdownService.TOCInfo.subscribe({next:function(e){t.TOCInfo=e}})},e.decorators=[{type:i.Component,args:[{selector:"nb-side-toc",template:"<div class=\"side-anchor-toc\">\n  <ol class=\"nav\">\n    <li *ngFor=\"let TOCItem of TOCInfo.children\"\n        [ngClass]=\"['item-level-' + TOCItem.indentLevel, 'nav-item', 'nav-item-active']\"\n    >\n      <a [href]=\"'#' + TOCItem.content\"\n         [ngClass]=\"['nav-item-link']\"\n         [ngStyle]=\"{'color': TOCItem.content === currentHeading ? themeColor : ''}\"\n      >\n        <span>{{ TOCItem.content }}</span>\n      </a>\n      <ol class=\"nav\">\n        <li *ngFor=\"let subItem of TOCItem.children\"\n            [ngClass]=\"['item-level-' + subItem.indentLevel, 'nav-item', 'nav-item-active']\"\n        >\n          <a [href]=\"'#' + subItem.content\"\n             [ngClass]=\"['nav-item-link']\"\n             [ngStyle]=\"{'color': subItem.content === currentHeading ? themeColor : ''}\"\n          >\n            <span>{{ subItem.content }}</span>\n          </a>\n        </li>\n      </ol>\n    </li>\n  </ol>\n</div>\n",styles:[".side-anchor-toc{display:flex;flex-direction:column;font-size:14px;margin:0 auto;padding:20px;color:gray}.side-anchor-toc a{color:#696969}.nav{margin:0}.nav-item{line-height:1.8;cursor:pointer}.nav-item-link{text-decoration:none;outline:0}"]}]}],e.ctorParameters=function(){return[{type:a}]},e.propDecorators={currentHeading:[{type:i.Input}],themeColor:[{type:i.Input}]},e}(),u=function(){function e(e){this.domSanitizer=e}return e.prototype.transform=function(e){return this.domSanitizer.bypassSecurityTrustHtml(e)},e.decorators=[{type:i.Pipe,args:[{name:"hTMLPipe"}]}],e.ctorParameters=function(){return[{type:o.DomSanitizer}]},e}(),p=function(){function e(){}return e.decorators=[{type:i.NgModule,args:[{declarations:[d,h,u],imports:[o.BrowserModule],exports:[d]}]}],e}();e.Ngr2MarkdownService=a,e.MarkdownOption=s,e.TOCItem=l,e.Ngr2MarkdownComponent=d,e.Ngr2MarkdownModule=p,e.ɵb=u,e.ɵa=h,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ngr2-markdown.umd.min.js.map