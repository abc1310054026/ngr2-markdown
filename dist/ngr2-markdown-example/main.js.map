{"version":3,"sources":["webpack:///./projects/ngr2-markdown/src/lib/control-bar/control-bar.component.css","webpack:///./projects/ngr2-markdown/src/lib/control-bar/control-bar.component.html","webpack:///./projects/ngr2-markdown/src/lib/control-bar/control-bar.component.ts","webpack:///./projects/ngr2-markdown/src/lib/core/dad/dragAndDrop.ts","webpack:///./projects/ngr2-markdown/src/lib/core/dad/dragAndDropContainer.ts","webpack:///./projects/ngr2-markdown/src/lib/core/dad/dragAndDropEvent.ts","webpack:///./projects/ngr2-markdown/src/lib/core/fileOperator.ts","webpack:///./projects/ngr2-markdown/src/lib/core/indexedDB/indexedDB.ts","webpack:///./projects/ngr2-markdown/src/lib/core/markdown/markdown.ts","webpack:///./projects/ngr2-markdown/src/lib/core/markdown/markdownMarker.ts","webpack:///./projects/ngr2-markdown/src/lib/core/markdown/markdwonRenderer.ts","webpack:///./projects/ngr2-markdown/src/lib/core/syncScroll.ts","webpack:///./projects/ngr2-markdown/src/lib/core/tree/tree.ts","webpack:///./projects/ngr2-markdown/src/lib/drag-and-drop.directive.ts","webpack:///./projects/ngr2-markdown/src/lib/edit-box/edit-box.component.css","webpack:///./projects/ngr2-markdown/src/lib/edit-box/edit-box.component.html","webpack:///./projects/ngr2-markdown/src/lib/edit-box/edit-box.component.ts","webpack:///./projects/ngr2-markdown/src/lib/file-browser/file-browser.component.css","webpack:///./projects/ngr2-markdown/src/lib/file-browser/file-browser.component.html","webpack:///./projects/ngr2-markdown/src/lib/file-browser/file-browser.component.ts","webpack:///./projects/ngr2-markdown/src/lib/menu/menu.component.css","webpack:///./projects/ngr2-markdown/src/lib/menu/menu.component.html","webpack:///./projects/ngr2-markdown/src/lib/menu/menu.component.ts","webpack:///./projects/ngr2-markdown/src/lib/ngr2-markdown.component.css","webpack:///./projects/ngr2-markdown/src/lib/ngr2-markdown.component.html","webpack:///./projects/ngr2-markdown/src/lib/ngr2-markdown.component.ts","webpack:///./projects/ngr2-markdown/src/lib/ngr2-markdown.module.ts","webpack:///./projects/ngr2-markdown/src/lib/pipe/htmlpipe.pipe.ts","webpack:///./projects/ngr2-markdown/src/lib/pipe/md.pipe.ts","webpack:///./projects/ngr2-markdown/src/lib/service/ngr2-markdown.service.ts","webpack:///./projects/ngr2-markdown/src/lib/side-toc/side-toc.component.css","webpack:///./projects/ngr2-markdown/src/lib/side-toc/side-toc.component.html","webpack:///./projects/ngr2-markdown/src/lib/side-toc/side-toc.component.ts","webpack:///./projects/ngr2-markdown/src/lib/status-bar/status-bar.component.css","webpack:///./projects/ngr2-markdown/src/lib/status-bar/status-bar.component.html","webpack:///./projects/ngr2-markdown/src/lib/status-bar/status-bar.component.ts","webpack:///./projects/ngr2-markdown/src/lib/sync-scroll/sync-scroll.directive.ts","webpack:///./projects/ngr2-markdown/src/lib/tool-bar/tool-bar.component.css","webpack:///./projects/ngr2-markdown/src/lib/tool-bar/tool-bar.component.html","webpack:///./projects/ngr2-markdown/src/lib/tool-bar/tool-bar.component.ts","webpack:///./projects/ngr2-markdown/src/lib/tree/tree-node-directive/tree-node-def.directive.ts","webpack:///./projects/ngr2-markdown/src/lib/tree/tree-node-directive/tree-node-toggle.directive.ts","webpack:///./projects/ngr2-markdown/src/lib/tree/tree-node/tree-node.component.css","webpack:///./projects/ngr2-markdown/src/lib/tree/tree-node/tree-node.component.html","webpack:///./projects/ngr2-markdown/src/lib/tree/tree-node/tree-node.component.ts","webpack:///./projects/ngr2-markdown/src/lib/tree/tree/tree.component.css","webpack:///./projects/ngr2-markdown/src/lib/tree/tree/tree.component.html","webpack:///./projects/ngr2-markdown/src/lib/tree/tree/tree.component.ts","webpack:///./projects/ngr2-markdown/src/lib/utils/textParser.ts","webpack:///./src/$_lazy_route_resource lazy namespace object","webpack:///./src/app/app.component.css","webpack:///./src/app/app.component.html","webpack:///./src/app/app.component.ts","webpack:///./src/app/app.module.ts","webpack:///./src/environments/environment.ts","webpack:///./src/main.ts"],"names":[],"mappings":"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","file":"main.js","sourcesContent":["module.exports = \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJwcm9qZWN0cy9uZ3IyLW1hcmtkb3duL3NyYy9saWIvY29udHJvbC1iYXIvY29udHJvbC1iYXIuY29tcG9uZW50LmNzcyJ9 */\"","module.exports = \"\"","import { Component, OnInit } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'nb-control-bar',\r\n  templateUrl: './control-bar.component.html',\r\n  styleUrls: ['./control-bar.component.css']\r\n})\r\nexport class ControlBarComponent implements OnInit {\r\n\r\n  constructor() { }\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n}\r\n","import {DragAndDropContainer} from './dragAndDropContainer';\r\nimport {DragAndDropEvent, DragAndDropEventType} from './dragAndDropEvent';\r\n\r\nexport class DragAndDropElement {\r\n\r\n  static ELEMENT_STYLE: CSSStyle = {\r\n    // cursor: 'grab'\r\n  };\r\n  static DEMO_STYLE: CSSStyle = {\r\n    opacity: '0.5'\r\n  };\r\n\r\n  // 右上, 左上, 左下, 右下分别对应的角度值\r\n  diagonal: {\r\n    RT_ANGLE,\r\n    LT_ANGLE,\r\n    LB_ANGLE,\r\n    RB_ANGLE\r\n  } = {\r\n    RT_ANGLE: Math.PI / 4,\r\n    LT_ANGLE: Math.PI / 4 * 3,\r\n    LB_ANGLE: Math.PI / 4 * 3 * -1,\r\n    RB_ANGLE: Math.PI / 4 * -1\r\n  };\r\n\r\n  private _el: HTMLElement;\r\n  private _parent: HTMLElement;\r\n  private _dadEvent: DragAndDropEvent;\r\n  parentContainer: DragAndDropContainer;\r\n  status: DragAndDropStatus;\r\n  clone: HTMLElement;\r\n  centerPoint: Point;\r\n  get clientRect(): ClientRect | DOMRect {\r\n    return this._el.getBoundingClientRect();\r\n  }\r\n\r\n  constructor (element: HTMLElement,\r\n               parentContainer: DragAndDropContainer,\r\n               elementStyle: CSSStyle = DragAndDropElement.ELEMENT_STYLE,\r\n               demoStyle: CSSStyle = DragAndDropElement.DEMO_STYLE,\r\n  ) {\r\n    this._el =                element               || null;\r\n    this.parentContainer =    parentContainer       || null;\r\n\r\n    this._parent  = this._el && this._el.parentElement                          || null;\r\n    this.clone    = this._el && (<HTMLElement> this._el.cloneNode(true))  || null;\r\n    Object.getOwnPropertyNames(elementStyle)\r\n      .forEach(value => {\r\n        this._el.style[value] = elementStyle[value];\r\n      });\r\n    Object.getOwnPropertyNames(demoStyle)\r\n      .forEach(value => {\r\n        this.clone.style[value] = demoStyle[value];\r\n      });\r\n\r\n    // set draggable property\r\n    this._el.draggable = true;\r\n    // add drag and drop event handler\r\n    this._dadEvent = new DragAndDropEvent(this._el,\r\n      {\r\n        'dragstart': {\r\n          eventType: DragAndDropEventType.DRAG_START,\r\n          stopPropagation: true,\r\n          listener: this.ondragstart.bind(this)\r\n        },\r\n        'drag': {\r\n          eventType: DragAndDropEventType.DRAG,\r\n          stopPropagation: true,\r\n          listener: this.ondrag.bind(this),\r\n          operatorOptions: {\r\n            throttleTime: 1000\r\n          }\r\n        },\r\n        'dragend': {\r\n          eventType: DragAndDropEventType.DRAG_END,\r\n          stopPropagation: true,\r\n          listener: this.ondragend.bind(this),\r\n        },\r\n        'dragenter': {\r\n          eventType: DragAndDropEventType.DRAG_ENTER,\r\n          listener: this.ondragenter.bind(this),\r\n          preventDefault: true,\r\n          operatorOptions: {\r\n            filter: (event) => {\r\n              if (!this.parentContainer.equals(event)) {\r\n                return false;\r\n              }\r\n              return this._el !== this.parentContainer.getDragElement()._el && this._el === event.target;\r\n            }\r\n          }\r\n        },\r\n        'dragover': {\r\n          eventType: DragAndDropEventType.DRAG_OVER,\r\n          listener: this.ondragover.bind(this),\r\n          operatorOptions: {\r\n            throttleTime: 100,\r\n            filter: (event) => {\r\n              if (!this.parentContainer.equals(event)) {\r\n                return false;\r\n              }\r\n              return this._el !== this.parentContainer.getDragElement()._el;\r\n            }\r\n          },\r\n          preventDefault: true\r\n        },\r\n        'drop': {\r\n          eventType: DragAndDropEventType.DROP,\r\n          stopPropagation: true,\r\n          listener: this.ondrop.bind(this)\r\n        }\r\n      });\r\n    this._dadEvent.observable\r\n      .subscribe(value => {});\r\n\r\n    // initial\r\n    this.status = 'none';\r\n    const rect = this.clientRect;\r\n    this.centerPoint = new Point((rect.left + rect.width / 2),\r\n      (rect.top + rect.height / 2));\r\n  }\r\n\r\n  /**\r\n   * @deprecated\r\n   */\r\n  reset(): void {\r\n    this.transitDemonstrationFinish(this.parentContainer.getDragElement());\r\n  }\r\n\r\n  /**\r\n   * drag start\r\n   * 用户开始拖动本元素时触发\r\n   * @param ev - emit event\r\n   */\r\n  private ondragstart(ev: DragEvent) {\r\n    console.group('on drop start');\r\n    this.status = 'drag';\r\n    this.parentContainer.setDragElement(this, ev);\r\n    console.groupEnd();\r\n  }\r\n\r\n  /**\r\n   * drag\r\n   * 用户正在拖动本元素时触发\r\n   * @param ev - emit event\r\n   */\r\n  private ondrag(ev: DragEvent) {\r\n    console.group('on drag');\r\n    console.groupEnd();\r\n  }\r\n\r\n  /**\r\n   * drag end\r\n   * 用户结束拖动本元素时触发\r\n   * @param ev - emit event\r\n   */\r\n  private ondragend(ev: DragEvent) {\r\n    console.group('on drag end');\r\n    this.status = 'none';\r\n    console.groupEnd();\r\n  }\r\n\r\n  /**\r\n   * drag enter\r\n   * 当另一个被拖动的元素, 进入本元素的容器范围时触发\r\n   * [目标放置说明]{@link https://developer.mozilla.org/zh-CN/docs/Web/API/HTML_Drag_and_Drop_API/Drag_operations#droptargets}\r\n   * @param ev - emit event\r\n   */\r\n  private ondragenter(ev: DragEvent) {\r\n    if (!(this.parentContainer.getDragElement()._parent === this._parent && this._el === ev.target)) { return; }\r\n    if (this._el === this.parentContainer.getDragElement()._el) { return; }\r\n    console.group('on drag enter');\r\n    this.status = 'drop';\r\n    this.parentContainer.setDropElement(this);\r\n    const rect = this.clientRect;\r\n    this.diagonal.RT_ANGLE = Math.atan2(rect.height / 2, rect.width / 2);\r\n    this.diagonal.LT_ANGLE = Math.PI - this.diagonal.RT_ANGLE;\r\n    this.diagonal.LB_ANGLE = -this.diagonal.LT_ANGLE;\r\n    this.diagonal.RB_ANGLE = -this.diagonal.RT_ANGLE;\r\n    console.groupEnd();\r\n  }\r\n\r\n  /**\r\n   * drag over\r\n   * 当另一个被拖动的元素, 在本元素的容器范围内时触发\r\n   * @param ev - emit event\r\n   */\r\n  private ondragover(ev: DragEvent) {\r\n    console.group('on drag over');\r\n    this.transitDemonstration(this.parentContainer.getDragElement(), new Point(ev.clientX, ev.clientY));\r\n    console.groupEnd();\r\n  }\r\n\r\n  /**\r\n   * @deprecated\r\n   * drag leave\r\n   * 当另一个被拖动的元素, 离开本元素的容器范围时触发\r\n   * @param ev - emit event\r\n   */\r\n  private ondragleave(ev: DragEvent) {\r\n    console.group('on drag leave');\r\n    this.status = 'none';\r\n    this.transitDemonstrationFinish(this.parentContainer.getDragElement());\r\n    console.groupEnd();\r\n  }\r\n\r\n  /**\r\n   * drag exit\r\n   * 当本元素变得不再可拖动时触发\r\n   * @deprecated\r\n   * [未被任何浏览器实现]{@link https://developer.mozilla.org/zh-CN/docs/Web/API/Document/dragexit_event}\r\n   * @param ev - emit event\r\n   */\r\n  private ondragexit(ev: DragEvent) {\r\n    console.group('on drag exit');\r\n    console.groupEnd();\r\n  }\r\n\r\n  /**\r\n   * drop\r\n   * 当另一个被拖动的元素, 在本元素的容器范围内释放鼠标时触发\r\n   * @param ev - emit event\r\n   */\r\n  private ondrop(ev: DragEvent) {\r\n    console.group('on drop');\r\n    this.status = 'drop';\r\n    this.replaceElement(this.parentContainer.getDragElement()._el, this.parentContainer.getDragElement().clone);\r\n    console.groupEnd();\r\n  }\r\n\r\n  private insertBefore(el: Element): Element {\r\n    return this._parent.insertBefore(el, this._el);\r\n  }\r\n\r\n  /**\r\n   * `nextElementSibling`: ie8,ie9,safari不兼容\r\n   * 见: https://developer.mozilla.org/en-US/docs/Web/API/NonDocumentTypeChildNode/nextElementSibling\r\n   * @param el - insert element\r\n   * @return - return inserted element\r\n   */\r\n  private insertAfter(el: Element): Element {\r\n    if (!this._el.nextElementSibling) {\r\n      return this._parent.appendChild(el);\r\n    }\r\n    return this._parent.insertBefore(el, this._el.nextElementSibling);\r\n  }\r\n\r\n  private computeDirection(point: Point): DragAndDropDirection {\r\n    this.centerPoint = new Point((this.clientRect.left + this.clientRect.width / 2),\r\n      (this.clientRect.top + this.clientRect.height / 2));\r\n    point.relaitiveTo(this.centerPoint);\r\n    const angle = Math.atan2(point.Y, point.X);\r\n    if (angle >= this.diagonal.RT_ANGLE && angle < this.diagonal.LT_ANGLE) {\r\n      return 'top';\r\n    } else if (angle >= this.diagonal.LT_ANGLE || angle < this.diagonal.LB_ANGLE) {\r\n      return 'left';\r\n    } else if (angle >= this.diagonal.LB_ANGLE && angle < this.diagonal.RB_ANGLE) {\r\n      return 'bottom';\r\n    } else {\r\n      return 'right';\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 演示鼠标拖动元素释放后的状态\r\n   */\r\n  private transitDemonstration(draggedEl: DragAndDropElement, point: Point) {\r\n    const dir = this.computeDirection(point);\r\n    if ( dir === 'top' || dir === 'left') {\r\n      this.insertBefore(draggedEl._el);\r\n    } else if (dir === 'bottom' || dir === 'right') {\r\n      this.insertAfter(draggedEl._el);\r\n    }\r\n    console.log(dir);\r\n  }\r\n\r\n  /**\r\n   * 演示结束, 移除元素\r\n   */\r\n  private transitDemonstrationFinish(dragElement: DragAndDropElement) {\r\n    this.removeElement(dragElement._el);\r\n  }\r\n\r\n  private removeElement(el: Element): Element {\r\n    for (let i = 0; i < this._parent.children.length; i++) {\r\n      if (this._parent.children[i] === el) {\r\n        this._parent.removeChild(el);\r\n        return el;\r\n      }\r\n    }\r\n  }\r\n\r\n  private replaceElement(newEl: Element, oldEl: Element): Element {\r\n    for (let i = 0; i < this._parent.children.length; i++) {\r\n      if (this._parent.children[i] === oldEl) {\r\n        this._parent.replaceChild(newEl, oldEl);\r\n        return oldEl;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nclass Point {\r\n  X: number;\r\n  Y: number;\r\n\r\n  constructor(X: number,\r\n              Y: number\r\n  ) {\r\n    this.X = X || null;\r\n    this.Y = Y || null;\r\n  }\r\n\r\n  relaitiveTo(relato: Point) {\r\n    this.X -= relato.X;\r\n    this.Y = relato.Y - this.Y;\r\n  }\r\n}\r\n\r\ntype DragAndDropStatus = 'none' | 'drag' | 'dragOver' | 'drop';\r\ntype DragAndDropDirection = 'top' | 'bottom' | 'left' | 'right' | 'center';\r\ntype CSSStyle = {\r\n  [P in keyof CSSStyleDeclaration]?: CSSStyleDeclaration[P];\r\n};\r\n","import {DragAndDropElement} from './dragAndDrop';\r\nimport {DragAndDropEvent, DragAndDropEventType} from './dragAndDropEvent';\r\nimport {assertNumber} from '@angular/core/src/render3/assert';\r\n\r\nexport class DragAndDropContainer {\r\n\r\n  private _el: HTMLElement;\r\n  private _children: HTMLCollection;\r\n  private _dragEl: DragAndDropElement;\r\n  private _dropEl: DragAndDropElement;\r\n  private _dadEvent: DragAndDropEvent;\r\n  private id: number;\r\n  DADChildren: Array<DragAndDropElement>;\r\n\r\n  constructor(element: HTMLElement\r\n  ) {\r\n    this._el =        element           || null;\r\n    this._children =  element.children  || null;\r\n\r\n    this.DADChildren = [];\r\n    for (let i = 0; i < this._children.length; i++) {\r\n      const el = new DragAndDropElement(\r\n        (<HTMLElement> this._children[i]),\r\n        this\r\n      );\r\n      this.DADChildren.push(el);\r\n    }\r\n  }\r\n\r\n  setDragElement(dragEl: DragAndDropElement, ev: DragEvent): void {\r\n    this._dragEl = dragEl;\r\n    this.id = new Date().getTime();\r\n    ev.dataTransfer.setData('text/containerid:' + this.id.toString(10), this.id.toString(10));\r\n  }\r\n\r\n  getDragElement(): DragAndDropElement {\r\n    return this._dragEl;\r\n  }\r\n\r\n  setDropElement(dropEl: DragAndDropElement): void {\r\n    this._dropEl = dropEl;\r\n  }\r\n\r\n  getDropElement(): DragAndDropElement {\r\n    return this._dropEl;\r\n  }\r\n\r\n  equals(ev: DragEvent): boolean {\r\n    let id = ev.dataTransfer.types[ev.dataTransfer.types.length - 1];\r\n\r\n    if (!id) { return false; }\r\n\r\n    id = id.split(':')[1];\r\n    return this.id === Number.parseInt(id, 10);\r\n  }\r\n}\r\n","import {fromEvent, merge, Observable} from 'rxjs';\r\nimport {filter, map, tap, throttleTime} from 'rxjs/operators';\r\n\r\nexport enum DragAndDropEventType {\r\n  DRAG_START = 'dragstart',\r\n  DRAG = 'drag',\r\n  DRAG_END = 'dragend',\r\n  DRAG_ENTER = 'dragenter',\r\n  DRAG_OVER = 'dragover',\r\n  DRAG_LEAVE = 'dragleave',\r\n  DROP = 'drop'\r\n}\r\n\r\nexport interface DragAndDropEventOptions {\r\n  eventType: DragAndDropEventType;\r\n  listener?: (event: DragEvent) => void | boolean;\r\n  preventDefault?: boolean;\r\n  stopPropagation?: boolean;\r\n  operatorOptions?: {\r\n    throttleTime?: number,\r\n    filter?: (event: DragEvent) => boolean\r\n  };\r\n  eventOptions?: EventListenerOptions;\r\n}\r\n\r\n// @dynamic\r\nexport class DragAndDropEvent {\r\n\r\n  /* tslint:disable */\r\n  static defaultFun = event => { console.group('on ' + event.type); console.groupEnd(); };\r\n  static ALL_OPTIONS: { [key: string]: DragAndDropEventOptions } = {\r\n    'dragstart': {\r\n      eventType: DragAndDropEventType.DRAG_START,\r\n      listener: DragAndDropEvent.defaultFun\r\n    },\r\n    'drag': {\r\n      eventType: DragAndDropEventType.DRAG,\r\n      listener: DragAndDropEvent.defaultFun,\r\n      operatorOptions: {\r\n        throttleTime: 1000\r\n      }\r\n    },\r\n    'dragend': {\r\n      eventType: DragAndDropEventType.DRAG_END,\r\n      listener: DragAndDropEvent.defaultFun,\r\n    },\r\n    'dragenter': {\r\n      eventType: DragAndDropEventType.DRAG_ENTER,\r\n      listener: DragAndDropEvent.defaultFun,\r\n      preventDefault: true\r\n    },\r\n    'dragover': {\r\n      eventType: DragAndDropEventType.DRAG_OVER,\r\n      listener: DragAndDropEvent.defaultFun,\r\n      operatorOptions: {\r\n        throttleTime: 100\r\n      },\r\n      preventDefault: true\r\n    },\r\n    'drop': {\r\n      eventType: DragAndDropEventType.DROP,\r\n      listener: DragAndDropEvent.defaultFun\r\n    }\r\n  };\r\n\r\n  el: Element;\r\n  observable: Observable<DragEvent>;\r\n  options: { [key: string]: DragAndDropEventOptions };\r\n  /*tslint:enable*/\r\n\r\n  // listeners: { [key: string]: (event: DragEvent) => void | boolean };\r\n  // ondragstart:  (event: DragEvent) => void | boolean;\r\n  // ondrag:       (event: DragEvent) => void | boolean;\r\n  // ondragend:    (event: DragEvent) => void | boolean;\r\n  // ondragenter:  (event: DragEvent) => void | boolean;\r\n  // ondragover:   (event: DragEvent) => void | boolean;\r\n  // ondragleave:  (event: DragEvent) => void | boolean;\r\n  // ondrop:       (event: DragEvent) => void | boolean;\r\n\r\n  constructor(el: Element,\r\n              eventOptions: { [key: string]: DragAndDropEventOptions } = DragAndDropEvent.ALL_OPTIONS,\r\n              interceptor?: (event: DragEvent) => boolean\r\n  ) {\r\n    this.el       = el;\r\n    this.options  = eventOptions;\r\n\r\n    this.observable = this.initEvent(interceptor);\r\n  }\r\n\r\n  private initEvent(interceptor?: (event: DragEvent) => boolean): Observable<DragEvent> {\r\n    const observables = Object.getOwnPropertyNames(this.options)\r\n      .reduce<Array<Observable<DragEvent>>>((previousValue, currentValue) => {\r\n        const option = this.options[currentValue];\r\n\r\n        let eventObservable = this.addEventListener(this.el, option);\r\n\r\n        eventObservable = this.addListenFunction(eventObservable, option);\r\n\r\n        previousValue.push(eventObservable);\r\n\r\n        return previousValue;\r\n      }, []);\r\n\r\n    return merge(...observables);\r\n  }\r\n\r\n  private addEventListener(el: Element,\r\n                           option: DragAndDropEventOptions,\r\n                           resultSelector: ((...args: any[]) => any) = (args => args)\r\n  ): Observable<DragEvent> {\r\n    let observable = fromEvent(el, option.eventType, option.eventOptions, resultSelector);\r\n\r\n    observable = this.eventOptions(observable, option);\r\n    observable = this.streamOperator(observable, option);\r\n\r\n    return observable;\r\n  }\r\n\r\n  private addListenFunction(observable: Observable<DragEvent>, option: DragAndDropEventOptions): Observable<DragEvent> {\r\n    if (!option.listener) {\r\n      return observable;\r\n    }\r\n    return observable.pipe(\r\n      tap(option.listener)\r\n    );\r\n  }\r\n\r\n  /**\r\n   * 根据option设置Event对象上的方法或属性\r\n   * @param observable\r\n   * @param option\r\n   */\r\n  private eventOptions(observable: Observable<DragEvent>, option: DragAndDropEventOptions): Observable<DragEvent> {\r\n    return observable\r\n      .pipe(\r\n        map((event: DragEvent) => {\r\n          if (option.preventDefault) { event.preventDefault(); }\r\n          if (option.stopPropagation) { event.stopPropagation(); event.cancelBubble = true; }\r\n          return event;\r\n        })\r\n      );\r\n  }\r\n\r\n  /**\r\n   * 根据option对事件流进行option中设置操作\r\n   * @param observable\r\n   * @param option\r\n   */\r\n  private streamOperator(observable: Observable<DragEvent>, option: DragAndDropEventOptions): Observable<DragEvent> {\r\n    if (!option.operatorOptions) { return observable; }\r\n    const operator = option.operatorOptions;\r\n\r\n    if (operator.throttleTime && operator.throttleTime > 0) {\r\n      observable = observable\r\n        .pipe(throttleTime(operator.throttleTime));\r\n    }\r\n    if (operator.filter) {\r\n      observable = observable\r\n        .pipe(filter(operator.filter));\r\n    }\r\n\r\n    return observable;\r\n  }\r\n}\r\n","import {fromEvent, merge, Observable} from 'rxjs';\r\nimport {map} from 'rxjs/operators';\r\n\r\nexport class FileOperatorImpl implements FileOperator {\r\n  result: string;\r\n  private fileReader = new FileReader();\r\n  toDataURL(fileOrBlob: File | Blob): Observable<FileProgressEvent> {\r\n    this.fileReader.readAsDataURL(fileOrBlob);\r\n    return this.mergeFileReader(this.fileReader);\r\n  }\r\n\r\n  toText(fileOrBlob: File | Blob, encoding?: string): Observable<FileProgressEvent> {\r\n    this.fileReader.readAsText(fileOrBlob, encoding);\r\n    return this.mergeFileReader(this.fileReader);\r\n  }\r\n\r\n  toArrayBuffer(fileOrBlob: File | Blob): Observable<FileProgressEvent> {\r\n    this.fileReader.readAsArrayBuffer(fileOrBlob);\r\n    return this.mergeFileReader(this.fileReader);\r\n  }\r\n\r\n  toDataURLSync(fileOrBlob: File | Blob): string {\r\n    this.result = window.URL.createObjectURL(fileOrBlob);\r\n    return this.result;\r\n  }\r\n\r\n  revokeDataURLSync(): void {\r\n    window.URL.revokeObjectURL(this.result);\r\n  }\r\n\r\n  private mergeFileReader(fileReader: FileReader): Observable<FileProgressEvent> {\r\n    return merge(...[fromEvent(fileReader, 'load'),\r\n      fromEvent(fileReader, 'loadstart'),\r\n      fromEvent(fileReader, 'loadend'),\r\n      fromEvent(fileReader, 'progress'),\r\n      fromEvent(fileReader, 'error'),\r\n      fromEvent(fileReader, 'abort')])\r\n      .pipe(\r\n        map((value: ProgressEvent): FileProgressEvent => {\r\n          return Object.assign(value, {\r\n            result: fileReader.result || '',\r\n            error: fileReader.error || null\r\n          });\r\n        })\r\n      );\r\n  }\r\n}\r\n\r\nexport interface FileOperator {\r\n  toDataURL(fileOrBlob: File | Blob): Observable<FileProgressEvent>;\r\n  toText(fileOrBlob: File | Blob, encoding?: string): Observable<FileProgressEvent>;\r\n  toArrayBuffer(fileOrBlob: File | Blob): Observable<FileProgressEvent>;\r\n  toDataURLSync(fileOrBlob: File | Blob): string;\r\n  revokeDataURLSync(): void;\r\n}\r\n\r\nexport interface FileProgressEvent extends ProgressEvent {\r\n  result?: string | ArrayBuffer | null;\r\n  error?: DOMException | null;\r\n}\r\n","import {concat, from, Observable, Subscriber} from 'rxjs';\r\nimport {mergeMap, scan} from 'rxjs/operators';\r\nimport {el} from '@angular/platform-browser/testing/src/browser_util';\r\n\r\n// @dynamic\r\nexport class IndexedDB {\r\n  static O_S_STRUCT = [\r\n    {\r\n      name: 'testStore',\r\n      optionalParameters: {\r\n        keyPath: 'id'\r\n      },\r\n      indexes: [\r\n        {\r\n          name: 'storeName',\r\n          keyPath: 'storeName',\r\n          options: {\r\n            unique: false\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  ];\r\n\r\n  private _db: IDBDatabase;\r\n  private objectStoreStructs: Array<IndexedDBStruct>;\r\n\r\n  private constructor(dbName: string = 'testDB',\r\n                      objectStoreStructs: Array<IndexedDBStruct> = IndexedDB.O_S_STRUCT,\r\n                      subscriber: Subscriber<IndexedDB>\r\n  ) {\r\n    this.objectStoreStructs = objectStoreStructs;\r\n\r\n    const request = window.indexedDB.open(dbName);\r\n    request.onerror = (event: Event) => {\r\n      alert('Database error: ' + (<IDBOpenDBRequest> event.target).error);\r\n    };\r\n\r\n    request.onsuccess  = (event: Event): any => {\r\n      console.log(`IndexedDB open success`);\r\n      this._db = request.result;\r\n      subscriber.next(this);\r\n    };\r\n\r\n    /**\r\n     * use to initial database\r\n     * @param event\r\n     */\r\n    request.onupgradeneeded = (event: IDBVersionChangeEvent) => {\r\n      console.log(`IndexedDB upgrade need`);\r\n      this._db = request.result;\r\n\r\n      this.objectStoreStructs.forEach(store => {\r\n        const objectStore: IDBObjectStore = this._db.createObjectStore(store.name, store.optionalParameters);\r\n        if (store.indexes) {\r\n          store.indexes.forEach(index => {\r\n            objectStore.createIndex(\r\n              index.name,\r\n              index.keyPath || index.name,\r\n              index.options);\r\n          });\r\n        }\r\n      });\r\n    };\r\n  }\r\n\r\n  static instenceof(dbName: string = 'testDB',\r\n                    objectStoreStructs: Array<IndexedDBStruct> = IndexedDB.O_S_STRUCT\r\n  ): Observable<IndexedDB> {\r\n    return new Observable(subscriber => {\r\n      const indexedDB = new IndexedDB(dbName, objectStoreStructs, subscriber);\r\n    });\r\n  }\r\n  /**\r\n   * get object store specify name and mode\r\n   * @param storeName\r\n   * @param mode\r\n   */\r\n  getObjectStore(storeName: string, mode: IDBTransactionMode): IndexedDBStore {\r\n    return new IndexedDBStore(this._db.transaction(storeName, mode).objectStore(storeName));\r\n  }\r\n}\r\n\r\nexport class IndexedDBStore {\r\n  /**\r\n   * IndexedDB ObjectStore represent a object store (like table in sql database)\r\n   */\r\n  objectStore: IDBObjectStore;\r\n\r\n  constructor(objectStore: IDBObjectStore) {\r\n    this.objectStore = objectStore;\r\n  }\r\n\r\n  add<T>(data: T): Observable<IndexedDBEvent<IDBValidKey>> {\r\n    return new Observable<IndexedDBEvent<IDBValidKey>>((subscriber: Subscriber<IndexedDBEvent<IDBValidKey>>) => {\r\n      const request: IDBRequest<IDBValidKey> = this.objectStore.add(data);\r\n      this.initRequest(request, subscriber);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * return Observable object send IndexedDBEvent multiple time\r\n   * @param data - add to store object array\r\n   */\r\n  addAll<T>(data: T[]): Observable<IndexedDBEvent<Array<IDBValidKey>>> {\r\n    const addObservables: Array<Observable<IndexedDBEvent<IDBValidKey>>> = data.map(\r\n      (item: T): Observable<IndexedDBEvent<IDBValidKey>> => this.add(item));\r\n    return this._concat_scan<IDBValidKey>(...addObservables);\r\n  }\r\n\r\n  /**\r\n   * return Observable object send IndexedDBEvent\r\n   * if IndexedDBEvent.type is IndexedDBEventType.SUCCESS then get data from IndexedDBEvent.data\r\n   * @param key\r\n   */\r\n  getById<T>(key: IDBValidKey): Observable<IndexedDBEvent<T>> {\r\n    return new Observable<IndexedDBEvent<T>>((subscriber: Subscriber<IndexedDBEvent<T>>) => {\r\n      const request: IDBRequest<T> = this.objectStore.get(key);\r\n      this.initRequest(request, subscriber);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * 兼容ie11-10, ie10不支持IndexedDB.getAll()方法, 用openCursor替代\r\n   * [IndexedDB.IDBObjectStore]{@link https://developer.mozilla.org/en-US/docs/Web/API/IDBObjectStore}\r\n   */\r\n  getAll<T>(): Observable<IndexedDBEvent<Array<T>>> {\r\n    const observable = new Observable<IndexedDBEvent<T>>((subscriber: Subscriber<IndexedDBEvent<T>>) => {\r\n      const request: IDBRequest<IDBCursorWithValue> = this.objectStore.openCursor();\r\n\r\n      request.onsuccess = (event: Event) => {\r\n        const cursor = request.result;\r\n        if (cursor) {\r\n          subscriber.next(new IndexedDBEvent<T>(IndexedDBEventType.COMPLETE, 1, 1, cursor.value));\r\n          cursor.continue();\r\n        } else {\r\n          subscriber.complete();\r\n        }\r\n      };\r\n      request.onerror = (event: Event) => {\r\n        subscriber.next(new IndexedDBEvent<T>(IndexedDBEventType.ERROR, 0, 0));\r\n        subscriber.complete();\r\n      };\r\n      // this.initRequest<Array<T>>(request, subscriber);\r\n    });\r\n    return this.getCount()\r\n      .pipe(\r\n        mergeMap((value: IndexedDBEvent<number>) => this._from_scan(observable, value.data))\r\n      );\r\n  }\r\n  /**\r\n   * return Observable object will send IndexedDBEvent multiple time\r\n   * will add T to IndexedDBEvent.data every time\r\n   * @param keys - ids\r\n   */\r\n  getAllById<T>(...keys: Array<IDBValidKey>): Observable<IndexedDBEvent<Array<T>>> {\r\n    const getObservables: Array<Observable<IndexedDBEvent<T>>> = keys.map(\r\n      (item: IDBValidKey): Observable<IndexedDBEvent<T>> => this.getById(item));\r\n    return this._concat_scan(...getObservables);\r\n  }\r\n\r\n  /**\r\n   * like getAllById but parameter type is IDBIndex\r\n   * @param indexName - index name\r\n   */\r\n  getAllByIndex<T>(indexName: string): Observable<IndexedDBEvent<Array<T>>> {\r\n    const index = this.objectStore.index(indexName);\r\n    const observable = new Observable<IndexedDBEvent<T>>((subscriber: Subscriber<IndexedDBEvent<T>>) => {\r\n      const request: IDBRequest<IDBCursorWithValue> = index.openCursor();\r\n      request.onsuccess = (event: Event) => {\r\n        const cursor: IDBCursorWithValue = request.result;\r\n        if (cursor) {\r\n          subscriber.next(new IndexedDBEvent<T>(IndexedDBEventType.COMPLETE, 1, 1, <T> cursor.value));\r\n          cursor.continue();\r\n        } else {\r\n          subscriber.complete();\r\n        }\r\n      };\r\n      request.onerror = (event: Event) => {\r\n        subscriber.next(new IndexedDBEvent<T>(IndexedDBEventType.ERROR, 0, 0));\r\n        subscriber.complete();\r\n      };\r\n    });\r\n\r\n    return this.getCount(index)\r\n      .pipe(\r\n        mergeMap((value: IndexedDBEvent<number>) => this._from_scan(observable, value.data))\r\n      );\r\n  }\r\n\r\n  /**\r\n   * return observable object send IndexedDBEvent\r\n   * if success IndexedDBEvent.data is updated object primary key\r\n   * @param data\r\n   */\r\n  update<T>(data: T): Observable<IndexedDBEvent<IDBValidKey>> {\r\n    return new Observable<IndexedDBEvent<IDBValidKey>>((subscriber: Subscriber<IndexedDBEvent<IDBValidKey>>) => {\r\n      const request: IDBRequest<IDBValidKey> = this.objectStore.put(data);\r\n      this.initRequest(request, subscriber);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * return observable object send IndexedDBEvent multiple time\r\n   * every time will add success updated object primary key to IndexedDBEvent.data\r\n   * @param data\r\n   */\r\n  updateAll<T>(data: T[]): Observable<IndexedDBEvent<Array<IDBValidKey>>> {\r\n    const updateObservables: Array<Observable<IndexedDBEvent<IDBValidKey>>> = data.map(\r\n      (item: T): Observable<IndexedDBEvent<IDBValidKey>> => this.update(item));\r\n    return this._concat_scan<IDBValidKey>(...updateObservables);\r\n  }\r\n\r\n  /**\r\n   * delete\r\n   * if success return IndexedDBEvent.data type is undefined\r\n   * @param key\r\n   */\r\n  delete(key: IDBValidKey | IDBKeyRange): Observable<IndexedDBEvent<undefined>> {\r\n    return new Observable<IndexedDBEvent<undefined>>((subscriber: Subscriber<IndexedDBEvent<undefined>>) => {\r\n      const request: IDBRequest<undefined> = this.objectStore.delete(key);\r\n      this.initRequest(request, subscriber);\r\n    });\r\n  }\r\n\r\n  deleteAll(...keys: (IDBValidKey | IDBKeyRange)[]): Observable<IndexedDBEvent<Array<IDBValidKey>>> {\r\n    const deleteObservables: Array<Observable<IndexedDBEvent<IDBValidKey>>> = keys.map(\r\n      (item: IDBValidKey | IDBKeyRange): Observable<IndexedDBEvent<IDBValidKey>> => this.delete(item));\r\n    return this._concat_scan<IDBValidKey>(...deleteObservables);\r\n  }\r\n\r\n  /**\r\n   * return observable object send IndexedDBEvent, IndexedDBEvent.data is IDBObjectStore or IDBIndex contain element's count\r\n   * @param object\r\n   * @param key\r\n   */\r\n  getCount(object?: IDBIndex, key?: IDBValidKey | IDBKeyRange): Observable<IndexedDBEvent<number>> {\r\n    return new Observable((subscriber: Subscriber<IndexedDBEvent<number>>) => {\r\n      const request: IDBRequest<number> = object === undefined ? this.objectStore.count() : object.count();\r\n      this.initRequest(request, subscriber);\r\n    });\r\n  }\r\n\r\n  private initRequest<T>(request: IDBRequest<T>, subscriber: Subscriber<IndexedDBEvent<T | DOMException>>): void {\r\n    request.onsuccess = () => {\r\n      if (request.result !== undefined) {\r\n        subscriber.next(new IndexedDBEvent<T>(IndexedDBEventType.COMPLETE, 1, 1, request.result));\r\n      } else {\r\n        subscriber.next(new IndexedDBEvent<T>(IndexedDBEventType.ERROR, 0, 0));\r\n      }\r\n      subscriber.complete();\r\n    };\r\n    // request出错返回错误信息\r\n    request.onerror = (event: Event) => {\r\n      subscriber.next(new IndexedDBEvent<DOMException>(IndexedDBEventType.ERROR, 0, 0, request.error));\r\n      subscriber.complete();\r\n    };\r\n  }\r\n\r\n  /**\r\n   * create observable use rxjs from function then use scan operator\r\n   * return custom event(IndexedDBEvent)\r\n   * @param observable\r\n   * @param total\r\n   */\r\n  private _from_scan<T>(observable: Observable<IndexedDBEvent<T>>, total: number): Observable<IndexedDBEvent<Array<T>>> {\r\n    return observable\r\n      .pipe(\r\n        scan<IndexedDBEvent<T>, IndexedDBEvent<Array<T>>>(\r\n          (acc: IndexedDBEvent<Array<T>>, value: IndexedDBEvent<T>): IndexedDBEvent<Array<T>> => {\r\n            if (value.type !== IndexedDBEventType.ERROR) {\r\n              acc.loaded++;\r\n              acc.data.push(value.data);\r\n              if (acc.loaded === acc.total) { acc.type = IndexedDBEventType.COMPLETE; }\r\n            } else {\r\n              acc.type = IndexedDBEventType.ERROR;\r\n              acc.loaded = 0;\r\n            }\r\n            return acc;\r\n          },\r\n          new IndexedDBEvent<Array<T>>(IndexedDBEventType.PENDING, 0, total, new Array<T>()))\r\n      );\r\n  }\r\n\r\n  /**\r\n   * connect observable use rxjs concat function(not Operator) then use scan operator\r\n   * return custom event(event: IndexedDBEvent)\r\n   * @param observables\r\n   */\r\n  private _concat_scan<T>(...observables: Array<Observable<IndexedDBEvent<T>>>): Observable<IndexedDBEvent<Array<T>>> {\r\n    const total = observables.length;\r\n    return concat(...observables)\r\n      .pipe(\r\n        scan<IndexedDBEvent<T>, IndexedDBEvent<Array<T>>>(\r\n          (acc: IndexedDBEvent<Array<T>>, value: IndexedDBEvent<T>): IndexedDBEvent<Array<T>> => {\r\n            if (value.type !== IndexedDBEventType.ERROR) {\r\n              acc.loaded++;\r\n              acc.data.push(value.data);\r\n              if (acc.loaded === acc.total) { acc.type = IndexedDBEventType.COMPLETE; }\r\n            } else {\r\n              acc.type = IndexedDBEventType.ERROR;\r\n              acc.loaded = 0;\r\n            }\r\n            return acc;\r\n          },\r\n          new IndexedDBEvent<Array<T>>(IndexedDBEventType.PENDING, 0, total, new Array<T>()))\r\n      );\r\n  }\r\n}\r\n\r\nexport interface IndexedDBStruct {\r\n  name: string;\r\n  optionalParameters: IDBObjectStoreParameters;\r\n  indexes: Array<{\r\n    name: string,\r\n    keyPath?: string,\r\n    options: IDBIndexParameters\r\n  }>;\r\n}\r\n/**\r\n * IndexedDB function return value\r\n * use to flag IndexedDB event status and loaded status\r\n */\r\nexport class IndexedDBEvent<T> {\r\n  type: IndexedDBEventType;\r\n  loaded: number;\r\n  total: number;\r\n  data: T;\r\n\r\n  constructor(type: IndexedDBEventType, loaded: number, total: number, data?: T) {\r\n    this.type = type;\r\n    this.loaded = loaded;\r\n    this.total = total;\r\n    this.data = data === undefined ? undefined : data;\r\n  }\r\n}\r\n\r\nexport enum IndexedDBEventType {\r\n  PENDING = 'Pending',\r\n  SUCCESS = 'Success',\r\n  ERROR = 'Error',\r\n  COMPLETE = 'Complete'\r\n}\r\n","// import * as MarkdownIt from 'markdown-it';\r\n// 如上用TS的@types包装引入在ie11中无法兼容, 在打包出来的vendor.js中会有一行使用了箭头函数的代码报(语法错误)\r\n// 直接引入markdown-it.min.js可以避免\r\nimport * as MarkdownIt from 'node_modules/markdown-it/dist/markdown-it.min.js';\r\nimport {Observable, Observer} from 'rxjs';\r\nimport * as hljs from 'highlight.js';\r\n\r\nexport class MarkdownImpl implements Markdown {\r\n  markdownIt: MarkdownIt;\r\n\r\n  constructor() {\r\n    this.markdownIt = new MarkdownIt({\r\n      highlight: (str: string, lang: string) => {\r\n        if (lang && hljs.getLanguage(lang)) {\r\n          try {\r\n            return '<pre class=\"hljs\"><code>' +\r\n              hljs.highlight(lang, str).value +\r\n              '</code></pre>';\r\n          } catch (__) {}\r\n        }\r\n        return '<pre class=\"hljs\"><code>' + this.markdownIt.utils.escapeHtml(str) + '</code>';\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * render markdown text function\r\n   * 渲染函数\r\n   * @param markdown - markdown format text - markdown格式的文本\r\n   * @param options - use to open or close plugins\r\n   * @return - return transformation html - 返回渲染后的html\r\n   */\r\n  render(markdown: string, options?: MarkdownOption) {\r\n    this.disable(options);\r\n    const html = this.markdownIt.render(markdown);\r\n    this.enable(options);\r\n    return html;\r\n  }\r\n\r\n  /**\r\n   * fn: 传入的方法可以对md的内容进行处理, 处理结果由subject发出\r\n   * fn.md: Markdown对象内容都在里面\r\n   * fm.subject: 观察者, 处理结果由此传出\r\n   * @param fn\r\n   */\r\n  use<T>(fn: (md: MarkdownIt, subject: Observer<T>) => void): Observable<T> {\r\n    const md = this.markdownIt;\r\n    const observable = new Observable<T>(function (subscriber) {\r\n      md.use(fn, subscriber);\r\n    });\r\n    return observable;\r\n  }\r\n\r\n  enable(option: MarkdownOption) {\r\n    if (!option) { return; }\r\n    const enableRules = Object.keys(option).filter((value => {\r\n      return !option[value];\r\n    }));\r\n    this.markdownIt.enable(enableRules);\r\n  }\r\n\r\n  disable(option: MarkdownOption) {\r\n    if (!option) { return; }\r\n    const disableRules = Object.keys(option).filter((value => {\r\n      return !option[value];\r\n    }));\r\n    this.markdownIt.disable(disableRules);\r\n  }\r\n}\r\n\r\nexport class MarkdownOptionImpl implements MarkdownOption {\r\n  anchor: boolean;\r\n}\r\n\r\ninterface Markdown {\r\n  render(markdown: string, options: any);\r\n  use<T>(fn: (md: any, observer: Observer<T>) => void);\r\n  enable(option: MarkdownOption);\r\n  disable(option: MarkdownOption);\r\n}\r\n\r\ninterface MarkdownOption {\r\n  anchor: boolean;\r\n}\r\n","import {ExtRenderInfo} from './markdwonRenderer';\r\n\r\n// @dynamic\r\nexport class MarkdownMarker {\r\n\r\n  static headingRegExp = new RegExp(/^\\s*(#{1,6})\\s+.*\\s*$/);\r\n  static blockQuoteRegExp = new RegExp(/^\\s*>.*/);\r\n  static listItemRegExp = new RegExp(/^(\\d+|[*+\\-])\\s.*/);\r\n  static codeBlockRegExp = new RegExp(/^`{1,3}\\w*$/);\r\n\r\n  constructor() {\r\n  }\r\n\r\n  /**\r\n   * 判断是否符合Markdown规则\r\n   * @param text - 要判断的字符串\r\n   */\r\n  testMarks(text: string): MarkType {\r\n    if (MarkdownMarker.headingRegExp.test(text)) {\r\n      return MarkType.HEADING;\r\n    } else if (MarkdownMarker.blockQuoteRegExp.test(text)) {\r\n      return MarkType.BLOCK_QUOTE;\r\n    } else if (MarkdownMarker.listItemRegExp.test(text)) {\r\n      return MarkType.LIST_ITEM;\r\n    } else if (MarkdownMarker.codeBlockRegExp.test(text)) {\r\n      return MarkType.CODE_BLOCK;\r\n    } else {\r\n      return MarkType.DEFAULT;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 传入符合heading的字符串，返回解析的数据(`#`号个数)\r\n   * @param text - heading字符串\r\n   */\r\n  parseHeading(text: string): ExtRenderInfo {\r\n    if (!text) { return; }\r\n    let length;\r\n    length = MarkdownMarker.headingRegExp[Symbol.match](text)[1].length;\r\n\r\n    return {\r\n      headingLevel: length\r\n    };\r\n  }\r\n}\r\n\r\nexport enum MarkType {\r\n  HEADING     = 'heading',\r\n  BLOCK_QUOTE = 'block quote',\r\n  LIST_ITEM   = 'list item',\r\n  CODE_BLOCK  = 'code block',\r\n  CODE_INLINE = 'code inline',\r\n  NOTHING     = 'nothing',\r\n  DEFAULT     = 'default'\r\n}\r\n","import {MarkType} from './markdownMarker';\r\n\r\nexport class MarkdownRenderer {\r\n\r\n  curEl: HTMLElement;\r\n  curRange: Range;\r\n\r\n  constructor() {\r\n  }\r\n\r\n  /**\r\n   * 渲染`Range`\r\n   * @param range - 要渲染的`Range`\r\n   * @param type - 渲染的类型\r\n   * @param extra - 额外信息\r\n   */\r\n  renderRange(range: Range, type: MarkType, extra?: ExtRenderInfo) {\r\n    this.curRange = range;\r\n    return this.renderEl(this._getRangeEl(range), type, extra);\r\n  }\r\n\r\n  /**\r\n   * 渲染`HTMLElement`\r\n   * @param el - 要渲染的`HTMLElement`\r\n   * @param type - 渲染类型\r\n   * @param extra - 额外信息\r\n   */\r\n  renderEl(el: HTMLElement, type: MarkType, extra?: ExtRenderInfo) {\r\n    this.curEl = el;\r\n    switch (type) {\r\n      case MarkType.HEADING:\r\n        this._heading(extra);\r\n        break;\r\n      // case MarkType.BLOCK_QUOTE:\r\n      //   this._blockQuote(extra);\r\n      //   break;\r\n      // case MarkType.LIST_ITEM:\r\n      //   this._listItem(extra);\r\n      //   break;\r\n      // case MarkType.CODE_BLOCK:\r\n      //   this._codeBlock(extra);\r\n      //   break;\r\n      // case MarkType.CODE_INLINE:\r\n      //   this._codeInline(extra);\r\n      //   break;\r\n      case MarkType.DEFAULT:\r\n      default:\r\n        this._default(extra);\r\n        break;\r\n    }\r\n  }\r\n\r\n  private _heading(extra?: ExtRenderInfo) {\r\n    const level = extra && extra.headingLevel || 1;\r\n    if (this.curEl.className === 'h' + level) { return; }\r\n    this.curEl.className = 'h' + level;\r\n  }\r\n\r\n  private _blockQuote(extra?: ExtRenderInfo) {\r\n    if (this.curEl.className === 'blockquote') { return; }\r\n    this.curEl.className = 'blockquote';\r\n  }\r\n\r\n  private _listItem(extra?: ExtRenderInfo) {\r\n    if (this.curEl.className === 'li') { return; }\r\n    this.curEl.className = 'li';\r\n  }\r\n\r\n  private _codeBlock(extra?: ExtRenderInfo) {\r\n    if (this.curEl.className === 'code') { return; }\r\n\r\n    if (this.curEl.parentElement.className !== 'pre') {\r\n      this.curEl.className = 'pre';\r\n      const offset = this.curRange.startOffset;\r\n      const parEl = document.createElement('DIV');\r\n      parEl.appendChild(this.curRange.startContainer);\r\n      parEl.className = 'code';\r\n\r\n      this.curEl.appendChild(parEl);\r\n      this.curRange.setStart(parEl, offset);\r\n    } else {\r\n      this.curEl.className = 'code';\r\n    }\r\n  }\r\n\r\n  private _codeInline(extra?: ExtRenderInfo) {\r\n  }\r\n\r\n  private _default(extra?: ExtRenderInfo) {\r\n    if (this.curEl.className !== 'p') {\r\n      this.curEl.className = 'p';\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 获取Range的所在的元素节点(非文本节点)\r\n   * @param range - range\r\n   */\r\n  private _getRangeEl(range: Range): HTMLElement {\r\n    const startEl = range.startContainer;\r\n    let el: HTMLElement;\r\n\r\n    if (startEl.nodeType === Node.TEXT_NODE) {\r\n      el = startEl.parentElement;\r\n    } else if (startEl.nodeType === Node.ELEMENT_NODE) {\r\n      el = startEl as HTMLElement;\r\n    }\r\n\r\n    return el;\r\n  }\r\n}\r\n\r\nexport interface ExtRenderInfo {\r\n  headingLevel?: number;\r\n  [key: string]: any;\r\n}\r\n","export class SyncScroll {\r\n\r\n  private _el: HTMLElement;\r\n  queryString: string;\r\n  headingsInfo: Array<{\r\n    id: string,\r\n    pairId: string,\r\n    el: HTMLElement,\r\n    offsetTop: number,\r\n    height: number\r\n  }>;\r\n  suffix: string;\r\n\r\n  generateId: (node: Node, index: number, nodeList: NodeListOf<Node>) => string;\r\n\r\n  constructor(el: HTMLElement,\r\n              suffix: string,\r\n              generateIdFun: (node: Node, index: number, nodeList: NodeListOf<Node>) => string = node => (node as HTMLElement).id) {\r\n    this._el          = el;\r\n    this.suffix       = suffix;\r\n    this.generateId   = generateIdFun;\r\n\r\n    this.headingsInfo = [];\r\n  }\r\n\r\n  syncScrollByHeading(headingElType: 'tag' | 'class' = 'tag',\r\n                      headingKeys: Array<string> = ['h1', 'h2', 'h3', 'h4', 'h5', 'h6']) {\r\n\r\n    switch (headingElType) {\r\n      case 'class':\r\n        this.queryString = headingKeys.map(value => '.' + value).join(',');\r\n        break;\r\n      case 'tag':\r\n      default:\r\n        this.queryString = headingKeys.join(',');\r\n    }\r\n\r\n    this._update(this.queryString);\r\n  }\r\n\r\n  updateHeadingsInfo() {\r\n    this._update(this.queryString);\r\n  }\r\n\r\n  currentHeading(scrollTop: number = this._el.scrollTop): {\r\n    headingInfo: {\r\n      id: string,\r\n      pairId: string,\r\n      el: HTMLElement,\r\n      offsetTop: number,\r\n      height: number\r\n    },\r\n    scrollTop: number\r\n  } {\r\n    if (this.headingsInfo) { return this._curHeading(scrollTop); }\r\n    return null;\r\n  }\r\n\r\n  getPairHeading(pairId: string): {\r\n    headingInfo: {\r\n      id: string,\r\n      pairId: string,\r\n      el: HTMLElement,\r\n      offsetTop: number,\r\n      height: number\r\n    },\r\n    scrollTop: number\r\n  } {\r\n    for (let i = 0; i < this.headingsInfo.length; i++) {\r\n      if (this.headingsInfo[i].pairId === pairId) {\r\n        return {\r\n          headingInfo: this.headingsInfo[i],\r\n          scrollTop: this._el.scrollTop\r\n        };\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n\r\n  private _curHeading(scrollTop: number): {\r\n    headingInfo: {\r\n      id: string,\r\n      pairId: string,\r\n      el: HTMLElement,\r\n      offsetTop: number,\r\n      height: number\r\n    },\r\n    scrollTop: number\r\n  } {\r\n    if (this.headingsInfo.length <= 0) { return null; }\r\n\r\n    const el = this.headingsInfo.reduce((previousValue, currentValue) => {\r\n      if (currentValue.offsetTop > scrollTop) {\r\n        return previousValue;\r\n      }\r\n      if ((scrollTop - previousValue.offsetTop) > (scrollTop - currentValue.offsetTop)) {\r\n        return currentValue;\r\n      } else {\r\n        return previousValue;\r\n      }\r\n    });\r\n\r\n    return {\r\n      headingInfo: el,\r\n      scrollTop: scrollTop\r\n    };\r\n  }\r\n\r\n  private _update(queryString: string) {\r\n    const nodeList = this._el.querySelectorAll(queryString);\r\n\r\n    if (!nodeList || nodeList.length <= 0) { return; }\r\n\r\n    this.headingsInfo = [];\r\n\r\n    for (let i = 0; i < nodeList.length; i++) {\r\n      const curNode = nodeList[i] as HTMLElement;\r\n      const nextNodeOffset = (i + 1) >= nodeList.length ? this._el.scrollHeight : (nodeList[i + 1] as HTMLElement).offsetTop;\r\n\r\n      const pairId = this.generateId(curNode, i, nodeList);\r\n\r\n      this.headingsInfo.push({\r\n        id: pairId + '-' + this.suffix,\r\n        pairId: pairId,\r\n        el: curNode,\r\n        offsetTop: curNode.offsetTop,\r\n        height: nextNodeOffset - curNode.offsetTop\r\n      });\r\n    }\r\n  }\r\n}\r\n","export class Tree<T extends TreeableNode> {\r\n\r\n  private nodeMap: { [key: number]: Array<T> };\r\n  private nodes: Array<T>;\r\n  rootNode: TreeNode<T>;\r\n\r\n  constructor(nodes: Array<T>\r\n  ) {\r\n    this.nodes = nodes;\r\n\r\n    this.nodeMap = {};\r\n    this.initMap();\r\n    this.rootNode = this.generateTree();\r\n  }\r\n\r\n  /**\r\n   * 生成key: 父节点id, value: 父节点id为key的节点的Map\r\n   */\r\n  private initMap(): void {\r\n    for (let i = 0; i < this.nodes.length; i++) {\r\n      const node = this.nodes[i];\r\n\r\n      if (!this.nodeMap[node.parentId]) { this.nodeMap[node.parentId] = []; }\r\n      this.nodeMap[node.parentId].push(node);\r\n    }\r\n  }\r\n\r\n  private generateTree(id: number = -1, data?: T, parentId: number = -1, type: string = 'root'): TreeNode<T> {\r\n    const node = new TreeNode<T>();\r\n    node.id       = id;\r\n    node.data     = data;\r\n    node.parentId = parentId;\r\n    node.type     = type;\r\n    node.children = [];\r\n\r\n    const children = this.nodeMap[id];\r\n    if (!children) { return node; }\r\n\r\n    for (let i = 0; i < children.length; i++) {\r\n      node.push(this.generateTree(children[i].id, children[i], id, children[i].type));\r\n    }\r\n    return node;\r\n  }\r\n\r\n  recursionChildNodes(parentId: number): Array<T> {\r\n    if (!this.nodeMap[parentId]) { return []; }\r\n    const arr = [];\r\n    for (let i = 0; i < this.nodeMap[parentId].length; i++) {\r\n      const node = this.nodeMap[parentId][i];\r\n      arr.push(node);\r\n      arr.push(...this.recursionChildNodes(node.id));\r\n    }\r\n    return arr;\r\n  }\r\n}\r\n\r\nexport class TreeNode<T extends TreeableNode> implements TreeableNode {\r\n\r\n  id: number;\r\n  parentId: number;\r\n  type: string;\r\n  children: Array<TreeNode<T>>;\r\n  data: T;\r\n\r\n  constructor(id?: number,\r\n              parentId?: number,\r\n              type?: string,\r\n              data?: T\r\n  ) {\r\n    this.id       = id;\r\n    this.parentId = parentId;\r\n    this.type     = type;\r\n    this.data     = data;\r\n  }\r\n\r\n  push(node: TreeNode<T>): TreeNode<T> {\r\n    this.children.push(node);\r\n    return node;\r\n  }\r\n}\r\n\r\nexport interface TreeableNode {\r\n  id: number;\r\n  parentId: number;\r\n  type: string;\r\n  [key: string]: any;\r\n}\r\n","import {AfterViewInit, Directive, ElementRef, OnInit} from '@angular/core';\r\nimport {DragAndDropContainer} from './core/dad/dragAndDropContainer';\r\n\r\n@Directive({\r\n  selector: '[nbDragAndDrop]'\r\n})\r\nexport class DragAndDropDirective implements OnInit, AfterViewInit {\r\n\r\n  private DADContainer: DragAndDropContainer;\r\n\r\n  constructor(\r\n    private el: ElementRef\r\n  ) {\r\n  }\r\n\r\n  ngOnInit(): void {\r\n  }\r\n\r\n  ngAfterViewInit(): void {\r\n    this.DADContainer = new DragAndDropContainer(this.el.nativeElement);\r\n  }\r\n}\r\n","module.exports = \".edit-box {\\r\\n  display: flex;\\r\\n  flex-direction: column;\\r\\n  height: 100%;\\r\\n}\\r\\n\\r\\n.edit-tool-bar {\\r\\n  /* 定义基础高度25px */\\r\\n  flex: 0 0 25px;\\r\\n}\\r\\n\\r\\n/* 可编辑内容占据剩余的空间 */\\r\\n\\r\\n.edit-content {\\r\\n  flex: 1 1 auto;\\r\\n  overflow: auto;\\r\\n}\\r\\n\\r\\n.edit-area {\\r\\n  position: relative;\\r\\n  /* 不可分割单词强制换行 */\\r\\n  overflow-wrap: break-word;\\r\\n  outline: none;\\r\\n  box-sizing: border-box;\\r\\n  min-height: 100%;\\r\\n  padding: 10px 10px 120px 10px;\\r\\n  background-color: white;\\r\\n}\\r\\n\\r\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInByb2plY3RzL25ncjItbWFya2Rvd24vc3JjL2xpYi9lZGl0LWJveC9lZGl0LWJveC5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsYUFBYTtFQUNiLHNCQUFzQjtFQUN0QixZQUFZO0FBQ2Q7O0FBRUE7RUFDRSxlQUFlO0VBQ2YsY0FBYztBQUNoQjs7QUFFQSxpQkFBaUI7O0FBQ2pCO0VBQ0UsY0FBYztFQUNkLGNBQWM7QUFDaEI7O0FBRUE7RUFDRSxrQkFBa0I7RUFDbEIsZUFBZTtFQUNmLHlCQUF5QjtFQUN6QixhQUFhO0VBQ2Isc0JBQXNCO0VBQ3RCLGdCQUFnQjtFQUNoQiw2QkFBNkI7RUFDN0IsdUJBQXVCO0FBQ3pCIiwiZmlsZSI6InByb2plY3RzL25ncjItbWFya2Rvd24vc3JjL2xpYi9lZGl0LWJveC9lZGl0LWJveC5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmVkaXQtYm94IHtcclxuICBkaXNwbGF5OiBmbGV4O1xyXG4gIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XHJcbiAgaGVpZ2h0OiAxMDAlO1xyXG59XHJcblxyXG4uZWRpdC10b29sLWJhciB7XHJcbiAgLyog5a6a5LmJ5Z+656GA6auY5bqmMjVweCAqL1xyXG4gIGZsZXg6IDAgMCAyNXB4O1xyXG59XHJcblxyXG4vKiDlj6/nvJbovpHlhoXlrrnljaDmja7liankvZnnmoTnqbrpl7QgKi9cclxuLmVkaXQtY29udGVudCB7XHJcbiAgZmxleDogMSAxIGF1dG87XHJcbiAgb3ZlcmZsb3c6IGF1dG87XHJcbn1cclxuXHJcbi5lZGl0LWFyZWEge1xyXG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcclxuICAvKiDkuI3lj6/liIblibLljZXor43lvLrliLbmjaLooYwgKi9cclxuICBvdmVyZmxvdy13cmFwOiBicmVhay13b3JkO1xyXG4gIG91dGxpbmU6IG5vbmU7XHJcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcclxuICBtaW4taGVpZ2h0OiAxMDAlO1xyXG4gIHBhZGRpbmc6IDEwcHggMTBweCAxMjBweCAxMHB4O1xyXG4gIGJhY2tncm91bmQtY29sb3I6IHdoaXRlO1xyXG59XHJcbiJdfQ== */\"","module.exports = \"<div class=\\\"edit-box\\\"\\r\\n>\\r\\n  <!-- tool bar -->\\r\\n  <!-- 工具栏 扩展用 -->\\r\\n  <div class=\\\"edit-tool-bar\\\"\\r\\n  >\\r\\n    edit tool bar\\r\\n  </div>\\r\\n  <!-- edit content -->\\r\\n  <!-- 编辑框 -->\\r\\n  <!--disable: nbSyncScroll-->\\r\\n  <div #editWindow\\r\\n       class=\\\"edit-content\\\"\\r\\n       nbSyncScroll\\r\\n       [syncScrollInfo]=\\\"syncScroll\\\"\\r\\n  >\\r\\n    <div #editArea\\r\\n         class=\\\"edit-area\\\"\\r\\n         contenteditable=\\\"true\\\"\\r\\n         (keyup)=\\\"keyUp($event)\\\"\\r\\n         (paste)=\\\"paste($event)\\\"\\r\\n    >\\r\\n    </div>\\r\\n  </div>\\r\\n</div>\\r\\n\"","import {Component, ElementRef, OnInit, ViewChild, ViewEncapsulation} from '@angular/core';\r\nimport {Observable, Subject} from 'rxjs';\r\nimport {debounceTime, distinctUntilChanged} from 'rxjs/operators';\r\nimport {Ngr2MarkdownService} from '../service/ngr2-markdown.service';\r\nimport {MarkdownMarker, MarkType} from '../core/markdown/markdownMarker';\r\nimport {MarkdownRenderer} from '../core/markdown/markdwonRenderer';\r\nimport {SyncScroll} from '../core/syncScroll';\r\n\r\n@Component({\r\n  selector: 'nb-edit-box',\r\n  templateUrl: './edit-box.component.html',\r\n  styleUrls: ['./edit-box.component.css'],\r\n  encapsulation: ViewEncapsulation.None\r\n})\r\nexport class EditBoxComponent implements OnInit {\r\n\r\n  @ViewChild('editArea', {read: ElementRef}) editAreaRef: ElementRef;\r\n  @ViewChild('editWindow', {read: ElementRef}) editWindowRef: ElementRef;\r\n\r\n  private _editArea: HTMLElement;\r\n  private _selection: Selection;\r\n  private contentChange: Subject<string> = new Subject<string>();\r\n  private marker: MarkdownMarker;\r\n  private renderer: MarkdownRenderer;\r\n\r\n  private get _range() { return this._selection.getRangeAt(0); }\r\n\r\n  syncScroll: SyncScroll;\r\n\r\n  set content(value: string) {\r\n    if (!value || value.length <= 0) {\r\n      this._editArea.innerHTML = '<div><br></div>';\r\n    } else {\r\n      this._editArea.innerText = value;\r\n    }\r\n  }\r\n  get content(): string {\r\n    return this._editArea.innerText.replace(/\\n\\n/g, '\\n');\r\n  }\r\n\r\n  constructor(private markdownService: Ngr2MarkdownService\r\n  ) {\r\n  }\r\n\r\n  ngOnInit() {\r\n    this._editArea  = this.editAreaRef.nativeElement;\r\n    this._editArea.focus();\r\n    this._selection = document.getSelection();\r\n\r\n    this.syncScroll = new SyncScroll(\r\n      this.editWindowRef.nativeElement,\r\n      'edit',\r\n      (node, index) => index + '-' + ((node as HTMLElement).className.charCodeAt(1) - 48)\r\n    );\r\n    this.syncScroll.syncScrollByHeading('class');\r\n    // const sk = new ShortcutKey(this._editArea);\r\n\r\n    this.marker   = new MarkdownMarker();\r\n    this.renderer = new MarkdownRenderer();\r\n\r\n    this.bindMdService();\r\n    this.bindMutationObserver();\r\n  }\r\n\r\n  keyUp(event: KeyboardEvent) {\r\n    const text = this._range.startContainer.textContent;\r\n    const type = this.marker.testMarks(text);\r\n\r\n    switch (type) {\r\n      case MarkType.HEADING:\r\n        this.renderer.renderRange(this._range, type, this.marker.parseHeading(text));\r\n        break;\r\n      default:\r\n        this.renderer.renderRange(this._range, type);\r\n        break;\r\n    }\r\n  }\r\n\r\n  paste(event: ClipboardEvent) {\r\n    const text = event.clipboardData.getData('text');\r\n    document.execCommand('insertText', false, text);\r\n    const children = this._editArea.children;\r\n    for (let i = 0; i < children.length; i++) {\r\n      const type = this.marker.testMarks(children[i].textContent);\r\n\r\n      switch (type) {\r\n        case MarkType.HEADING:\r\n          this.renderer.renderEl(children[i] as HTMLElement, type, this.marker.parseHeading(children[i].textContent));\r\n          break;\r\n        default:\r\n          this.renderer.renderEl(children[i] as HTMLElement, type);\r\n          break;\r\n      }\r\n    }\r\n    this.syncScroll.updateHeadingsInfo();\r\n    event.preventDefault();\r\n  }\r\n  /**\r\n   * 订阅MarkdownService的一些Subject/Observable\r\n   */\r\n  private bindMdService(): void {\r\n    // 订阅重置事件\r\n    this.markdownService.observerResetMarkdown()\r\n      .subscribe(md => {\r\n        this._editArea.innerHTML = '<div><br></div>';\r\n        this._editArea.focus();\r\n\r\n        document.execCommand('insertText', false, md);\r\n        const children = this._editArea.children;\r\n        for (let i = 0; i < children.length; i++) {\r\n          const type = this.marker.testMarks(children[i].textContent);\r\n\r\n          switch (type) {\r\n            case MarkType.HEADING:\r\n              this.renderer.renderEl(children[i] as HTMLElement, type, this.marker.parseHeading(children[i].textContent));\r\n              break;\r\n            default:\r\n              this.renderer.renderEl(children[i] as HTMLElement, type);\r\n              break;\r\n          }\r\n        }\r\n        this.syncScroll.updateHeadingsInfo();\r\n        // this.content = md;\r\n      });\r\n\r\n    this.markdownService\r\n      .updateMarkdown(this.observeText(200));\r\n  }\r\n\r\n  /**\r\n   * 观察文本的变化\r\n   * @param time - 延迟发出的时间\r\n   */\r\n  private observeText(time?: number): Observable<string> {\r\n    if (!time) {\r\n      return this.contentChange.asObservable();\r\n    }\r\n    return this.contentChange\r\n      .pipe(\r\n        distinctUntilChanged(),\r\n        debounceTime(time)\r\n      );\r\n  }\r\n\r\n  /**\r\n   * 绑定并开启MutationObserver, 触发时将markdown文本发送到`mdChange`\r\n   */\r\n  private bindMutationObserver() {\r\n    const _observer = new MutationObserver((mutations: Array<MutationRecord>, observer: MutationObserver) => {\r\n      this.syncScroll.updateHeadingsInfo();\r\n      this.contentChange.next(this.content);\r\n    });\r\n\r\n    _observer.observe(this._editArea, {\r\n      subtree: true,\r\n      childList: true,\r\n      characterData: true,\r\n      attributes: true\r\n    });\r\n  }\r\n}\r\n","module.exports = \".file-browser {\\r\\n  display: flex;\\r\\n  flex-direction: column;\\r\\n  height: 100%;\\r\\n  background-color: lightgray;\\r\\n}\\r\\n\\r\\n.file-browser .fb-button {\\r\\n  cursor: pointer;\\r\\n  padding: 1px 2px;\\r\\n  margin: 0;\\r\\n  border: 0;\\r\\n  outline: none;\\r\\n  height: 100%;\\r\\n  background-color: transparent;\\r\\n}\\r\\n\\r\\n/* icon hover on light background */\\r\\n\\r\\n.file-browser .fb-button_hover:hover {\\r\\n  background-color: rgba(0, 0, 0, 0.1);\\r\\n}\\r\\n\\r\\n.file-browser .fb-button_disable {\\r\\n  cursor: default;\\r\\n  opacity: 0.5;\\r\\n}\\r\\n\\r\\n.file-browser .fb-button_close {\\r\\n  float: right;\\r\\n}\\r\\n\\r\\n.file-browser .fb-header {\\r\\n  flex: 0 0 30px;\\r\\n  background-color: rgba(0, 0, 0, 0.1);\\r\\n}\\r\\n\\r\\n.file-browser .fb-list {\\r\\n  flex: 1 1 auto;\\r\\n  width: 200px;\\r\\n  overflow: auto;\\r\\n}\\r\\n\\r\\n.file-browser .fb-list ul {\\r\\n  list-style: none;\\r\\n  margin: 0 0 0 5px;\\r\\n  padding-left: 2px;\\r\\n}\\r\\n\\r\\n.file-browser .fb-list li {\\r\\n  display: flex;\\r\\n  box-sizing: border-box;\\r\\n  font-size: 12px;\\r\\n  padding: 2px;\\r\\n  margin: 3px;\\r\\n}\\r\\n\\r\\n.file-browser .fb-li_hover:hover {\\r\\n  background-color: rgba(0, 0, 0, 0.1);\\r\\n}\\r\\n\\r\\n.file-browser .fb-list li span {\\r\\n  white-space: nowrap;\\r\\n  text-overflow: ellipsis;\\r\\n  overflow: hidden;\\r\\n}\\r\\n\\r\\n.file-browser .fb-li_selected {\\r\\n  background-color: rgba(0, 0, 0, 0.2);\\r\\n}\\r\\n\\r\\n.file-browser .fb-li_selected:hover {\\r\\n  background-color: rgba(0, 0, 0, 0.2);\\r\\n}\\r\\n\\r\\n.file-browser .fb-li_create {\\r\\n  background-color: white;\\r\\n  width: 170px;\\r\\n}\\r\\n\\r\\n.file-browser .fb-li_create-input {\\r\\n  box-sizing: padding-box;\\r\\n  width: 100%;\\r\\n  padding: 0 0 0 5px;\\r\\n  outline: none;\\r\\n  border: none;\\r\\n}\\r\\n\\r\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInByb2plY3RzL25ncjItbWFya2Rvd24vc3JjL2xpYi9maWxlLWJyb3dzZXIvZmlsZS1icm93c2VyLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxhQUFhO0VBQ2Isc0JBQXNCO0VBQ3RCLFlBQVk7RUFDWiwyQkFBMkI7QUFDN0I7O0FBRUE7RUFDRSxlQUFlO0VBQ2YsZ0JBQWdCO0VBQ2hCLFNBQVM7RUFDVCxTQUFTO0VBQ1QsYUFBYTtFQUNiLFlBQVk7RUFDWiw2QkFBNkI7QUFDL0I7O0FBRUEsbUNBQW1DOztBQUNuQztFQUNFLG9DQUFvQztBQUN0Qzs7QUFFQTtFQUNFLGVBQWU7RUFDZixZQUFZO0FBQ2Q7O0FBRUE7RUFDRSxZQUFZO0FBQ2Q7O0FBRUE7RUFDRSxjQUFjO0VBQ2Qsb0NBQW9DO0FBQ3RDOztBQUVBO0VBQ0UsY0FBYztFQUNkLFlBQVk7RUFDWixjQUFjO0FBQ2hCOztBQUVBO0VBQ0UsZ0JBQWdCO0VBQ2hCLGlCQUFpQjtFQUNqQixpQkFBaUI7QUFDbkI7O0FBRUE7RUFDRSxhQUFhO0VBQ2Isc0JBQXNCO0VBQ3RCLGVBQWU7RUFDZixZQUFZO0VBQ1osV0FBVztBQUNiOztBQUVBO0VBQ0Usb0NBQW9DO0FBQ3RDOztBQUVBO0VBQ0UsbUJBQW1CO0VBQ25CLHVCQUF1QjtFQUN2QixnQkFBZ0I7QUFDbEI7O0FBRUE7RUFDRSxvQ0FBb0M7QUFDdEM7O0FBRUE7RUFDRSxvQ0FBb0M7QUFDdEM7O0FBRUE7RUFDRSx1QkFBdUI7RUFDdkIsWUFBWTtBQUNkOztBQUVBO0VBQ0UsdUJBQXVCO0VBQ3ZCLFdBQVc7RUFDWCxrQkFBa0I7RUFDbEIsYUFBYTtFQUNiLFlBQVk7QUFDZCIsImZpbGUiOiJwcm9qZWN0cy9uZ3IyLW1hcmtkb3duL3NyYy9saWIvZmlsZS1icm93c2VyL2ZpbGUtYnJvd3Nlci5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmZpbGUtYnJvd3NlciB7XHJcbiAgZGlzcGxheTogZmxleDtcclxuICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xyXG4gIGhlaWdodDogMTAwJTtcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiBsaWdodGdyYXk7XHJcbn1cclxuXHJcbi5maWxlLWJyb3dzZXIgLmZiLWJ1dHRvbiB7XHJcbiAgY3Vyc29yOiBwb2ludGVyO1xyXG4gIHBhZGRpbmc6IDFweCAycHg7XHJcbiAgbWFyZ2luOiAwO1xyXG4gIGJvcmRlcjogMDtcclxuICBvdXRsaW5lOiBub25lO1xyXG4gIGhlaWdodDogMTAwJTtcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDtcclxufVxyXG5cclxuLyogaWNvbiBob3ZlciBvbiBsaWdodCBiYWNrZ3JvdW5kICovXHJcbi5maWxlLWJyb3dzZXIgLmZiLWJ1dHRvbl9ob3Zlcjpob3ZlciB7XHJcbiAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgwLCAwLCAwLCAwLjEpO1xyXG59XHJcblxyXG4uZmlsZS1icm93c2VyIC5mYi1idXR0b25fZGlzYWJsZSB7XHJcbiAgY3Vyc29yOiBkZWZhdWx0O1xyXG4gIG9wYWNpdHk6IDAuNTtcclxufVxyXG5cclxuLmZpbGUtYnJvd3NlciAuZmItYnV0dG9uX2Nsb3NlIHtcclxuICBmbG9hdDogcmlnaHQ7XHJcbn1cclxuXHJcbi5maWxlLWJyb3dzZXIgLmZiLWhlYWRlciB7XHJcbiAgZmxleDogMCAwIDMwcHg7XHJcbiAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgwLCAwLCAwLCAwLjEpO1xyXG59XHJcblxyXG4uZmlsZS1icm93c2VyIC5mYi1saXN0IHtcclxuICBmbGV4OiAxIDEgYXV0bztcclxuICB3aWR0aDogMjAwcHg7XHJcbiAgb3ZlcmZsb3c6IGF1dG87XHJcbn1cclxuXHJcbi5maWxlLWJyb3dzZXIgLmZiLWxpc3QgdWwge1xyXG4gIGxpc3Qtc3R5bGU6IG5vbmU7XHJcbiAgbWFyZ2luOiAwIDAgMCA1cHg7XHJcbiAgcGFkZGluZy1sZWZ0OiAycHg7XHJcbn1cclxuXHJcbi5maWxlLWJyb3dzZXIgLmZiLWxpc3QgbGkge1xyXG4gIGRpc3BsYXk6IGZsZXg7XHJcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcclxuICBmb250LXNpemU6IDEycHg7XHJcbiAgcGFkZGluZzogMnB4O1xyXG4gIG1hcmdpbjogM3B4O1xyXG59XHJcblxyXG4uZmlsZS1icm93c2VyIC5mYi1saV9ob3Zlcjpob3ZlciB7XHJcbiAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgwLCAwLCAwLCAwLjEpO1xyXG59XHJcblxyXG4uZmlsZS1icm93c2VyIC5mYi1saXN0IGxpIHNwYW4ge1xyXG4gIHdoaXRlLXNwYWNlOiBub3dyYXA7XHJcbiAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7XHJcbiAgb3ZlcmZsb3c6IGhpZGRlbjtcclxufVxyXG5cclxuLmZpbGUtYnJvd3NlciAuZmItbGlfc2VsZWN0ZWQge1xyXG4gIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMCwgMCwgMCwgMC4yKTtcclxufVxyXG5cclxuLmZpbGUtYnJvd3NlciAuZmItbGlfc2VsZWN0ZWQ6aG92ZXIge1xyXG4gIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMCwgMCwgMCwgMC4yKTtcclxufVxyXG5cclxuLmZpbGUtYnJvd3NlciAuZmItbGlfY3JlYXRlIHtcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiB3aGl0ZTtcclxuICB3aWR0aDogMTcwcHg7XHJcbn1cclxuXHJcbi5maWxlLWJyb3dzZXIgLmZiLWxpX2NyZWF0ZS1pbnB1dCB7XHJcbiAgYm94LXNpemluZzogcGFkZGluZy1ib3g7XHJcbiAgd2lkdGg6IDEwMCU7XHJcbiAgcGFkZGluZzogMCAwIDAgNXB4O1xyXG4gIG91dGxpbmU6IG5vbmU7XHJcbiAgYm9yZGVyOiBub25lO1xyXG59XHJcbiJdfQ== */\"","module.exports = \"<div class=\\\"file-browser\\\">\\r\\n  <header class=\\\"fb-header\\\"\\r\\n  >\\r\\n    <button class=\\\"fb-button fb-button_hover\\\"\\r\\n            (click)=\\\"createFile()\\\"\\r\\n    >\\r\\n      <i class=\\\"material-icons md-dark\\\">\\r\\n        note_add\\r\\n      </i>\\r\\n    </button>\\r\\n    <!--创建文件夹暂时不可用-->\\r\\n    <!--(click)=\\\"createFolder()\\\"-->\\r\\n    <button class=\\\"fb-button fb-button_hover\\\"\\r\\n            (click)=\\\"createFolder()\\\"\\r\\n    >\\r\\n      <i class=\\\"material-icons md-dark\\\">\\r\\n        create_new_folder\\r\\n      </i>\\r\\n    </button>\\r\\n    <button class=\\\"fb-button fb-button_hover\\\"\\r\\n            (click)=\\\"delete()\\\"\\r\\n    >\\r\\n      <i class=\\\"material-icons md-dark\\\">\\r\\n        delete\\r\\n      </i>\\r\\n    </button>\\r\\n    <button class=\\\"fb-button fb-button_hover\\\"\\r\\n            (click)=\\\"rename()\\\"\\r\\n    >\\r\\n      <i class=\\\"material-icons md-dark\\\">\\r\\n        edit\\r\\n      </i>\\r\\n    </button>\\r\\n    <button class=\\\"fb-button fb-button_hover fb-button_close\\\"\\r\\n            (click)=\\\"close()\\\"\\r\\n    >\\r\\n      <i class=\\\"material-icons md-dark\\\">\\r\\n        close\\r\\n      </i>\\r\\n    </button>\\r\\n  </header>\\r\\n  <aside class=\\\"fb-list\\\"\\r\\n  >\\r\\n    <nb-tree [dataSource]=\\\"fileTree\\\"\\r\\n    >\\r\\n      <nb-tree-node *nbTreeNodeDef=\\\"let data = data\\\" [isExpanded]=\\\"data.isExpanded\\\">\\r\\n        <li *ngIf=\\\"data.type === 'folder'\\\"\\r\\n            class=\\\"fb-li_hover\\\"\\r\\n            (click)=\\\"select($any($event.currentTarget), data)\\\"\\r\\n            nbTreeNodeToggle\\r\\n            (callbackFn)=\\\"expanded($event)\\\"\\r\\n        >\\r\\n          <i class=\\\"material-icons md-18 md-dark\\\">\\r\\n            subdirectory_arrow_right\\r\\n          </i>\\r\\n          <span>{{ data.name }}</span>\\r\\n        </li>\\r\\n        <li *ngIf=\\\"data.type === 'article'\\\"\\r\\n            class=\\\"fb-li_hover\\\"\\r\\n            (click)=\\\"select($any($event.currentTarget), data)\\\"\\r\\n            (dblclick)=\\\"open($any($event.currentTarget), data)\\\"\\r\\n        >\\r\\n          <i class=\\\"material-icons md-18 md-dark\\\">\\r\\n            insert_drive_file\\r\\n          </i>\\r\\n          <span>{{ data.title }}</span>\\r\\n        </li>\\r\\n        <ul>\\r\\n          <ng-container nbTreeNodeOutlet></ng-container>\\r\\n        </ul>\\r\\n      </nb-tree-node>\\r\\n    </nb-tree>\\r\\n  </aside>\\r\\n</div>\\r\\n\"","import {Component, OnInit, Renderer2, ViewEncapsulation} from '@angular/core';\r\nimport {Ngr2MarkdownService} from '../service/ngr2-markdown.service';\r\nimport {IndexedDB, IndexedDBEvent, IndexedDBEventType, IndexedDBStruct} from '../core/indexedDB/indexedDB';\r\nimport {Tree, TreeableNode} from '../core/tree/tree';\r\nimport {concatMap} from 'rxjs/operators';\r\nimport {of} from 'rxjs';\r\nimport {TreeNodeComponent} from '../tree/tree-node/tree-node.component';\r\n\r\n@Component({\r\n  selector: 'nb-file-browser',\r\n  templateUrl: './file-browser.component.html',\r\n  styleUrls: [\r\n    './file-browser.component.css'\r\n  ],\r\n  encapsulation: ViewEncapsulation.None\r\n})\r\nexport class FileBrowserComponent implements OnInit {\r\n\r\n  /**\r\n   * 输入框模板\r\n   */\r\n  private inputArea: HTMLInputElement;\r\n  /**\r\n   * 用于初始化的IndexedDB数据库结构\r\n   */\r\n  private indexedDBStructs: Array<IndexedDBStruct> = [\r\n    {\r\n      name: 'markdown_article',\r\n      optionalParameters: {\r\n        keyPath: 'id',\r\n        autoIncrement: true\r\n      },\r\n      indexes: [\r\n        {\r\n          name: 'parentId',\r\n          keyPath: 'parentId',\r\n          options: {\r\n            unique: false\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  ];\r\n  private indexedDB: IndexedDB;\r\n  /**\r\n   * 被选择的节点\r\n   */\r\n  private selectedNode: {el: Element, data: TreeableNode};\r\n  fileTree: Tree<TreeableNode>;\r\n\r\n  constructor(private markdownService: Ngr2MarkdownService,\r\n              private renderer: Renderer2\r\n  ) {\r\n    // 创建输入框模板\r\n    const inputAreaLi: HTMLInputElement = renderer.createElement('LI');\r\n    this.renderer.addClass(inputAreaLi, 'fb-li');\r\n    this.renderer.addClass(inputAreaLi, 'fb-li_create');\r\n    const inputAreaI: HTMLElement = renderer.createElement('I');\r\n    this.renderer.addClass(inputAreaI, 'material-icons');\r\n    this.renderer.addClass(inputAreaI, 'md-18');\r\n    this.renderer.addClass(inputAreaI, 'md-dark');\r\n    this.renderer.appendChild(inputAreaI, this.renderer.createText('edit'));\r\n    const inputAreaInput: HTMLElement = renderer.createElement('INPUT');\r\n    this.renderer.addClass(inputAreaInput, 'fb-li_create-input');\r\n    this.renderer.appendChild(inputAreaLi, inputAreaI);\r\n    this.renderer.appendChild(inputAreaLi, inputAreaInput);\r\n\r\n    this.inputArea = inputAreaLi;\r\n  }\r\n\r\n  ngOnInit() {\r\n    // 获取数据库实例\r\n    IndexedDB.instenceof('ngr2-markdown-db', this.indexedDBStructs)\r\n      .subscribe(db => {\r\n        this.indexedDB = db;\r\n\r\n        const store = this.indexedDB.getObjectStore('markdown_article', 'readwrite');\r\n        // 数据库为空默认插入两条数据\r\n        store.getCount()\r\n          .pipe(\r\n            concatMap(value => {\r\n              if (value.data === 0) {\r\n                return store.addAll([new Folder(), new Article()]);\r\n              }\r\n              return of(new IndexedDBEvent(IndexedDBEventType.COMPLETE, 1, 1));\r\n            })\r\n          )\r\n          .subscribe(value => {\r\n            // 获取数据库中的所有文件\r\n            this.refreshArticles().then(() => {\r\n              // 找到最近修改的Article\r\n              const currentFile = this.fileTree.recursionChildNodes(-1)\r\n                .filter((file: TreeableNode) => file.type !== 'folder')\r\n                .reduce(\r\n                  (previousValue: Article, currentValue: Article) =>\r\n                    previousValue.lastModifiedTime > currentValue.lastModifiedTime ? previousValue : currentValue\r\n                );\r\n\r\n              // 发送当前的Article\r\n              this.markdownService.currentFile.next(currentFile);\r\n              this.markdownService.reinitialization((currentFile as Article).content);\r\n            });\r\n          });\r\n      });\r\n  }\r\n\r\n  createFile(): void {\r\n    const prtId = this.selectedNode &&\r\n      (this.selectedNode.data.type === 'folder' ? this.selectedNode.data.id : this.selectedNode.data.parentId) ||\r\n      null;\r\n    const parent = this.selectedNode &&\r\n      (this.selectedNode.data.type === 'folder' ?\r\n        this.selectedNode.el.parentElement.querySelector('ul') : this.selectedNode.el.parentElement.parentElement) ||\r\n      null;\r\n\r\n    const cloneEl = this.inputArea.cloneNode(true);\r\n\r\n    if (!parent || !prtId || !cloneEl) { console.error('unable create file'); }\r\n\r\n    this.renderer.listen(cloneEl, 'keyup', (ev: KeyboardEvent) => {\r\n      switch (ev.code) {\r\n        case 'Enter':\r\n          this.indexedDB\r\n            .getObjectStore('markdown_article', 'readwrite')\r\n            .add(new Article(prtId, 'article', 'ce', (<HTMLInputElement> ev.target).value))\r\n            .subscribe(value => {\r\n              this.refreshArticles();\r\n              this.renderer.removeChild(parent, cloneEl);\r\n            });\r\n      }\r\n    });\r\n    this.renderer.appendChild(parent, cloneEl);\r\n    (<HTMLElement> cloneEl).querySelector('input').focus();\r\n  }\r\n\r\n  createFolder(): void {\r\n    if (this.selectedNode.data.type !== 'folder') { return; }\r\n\r\n    const prtId = this.selectedNode &&\r\n      this.selectedNode.data.id ||\r\n      null;\r\n    const parent = this.selectedNode &&\r\n      this.selectedNode.el.parentElement.querySelector('ul') ||\r\n      null;\r\n\r\n    const cloneEl = this.inputArea.cloneNode(true);\r\n\r\n    if (!parent || !prtId || !cloneEl) { console.error('unable create folder'); }\r\n\r\n    this.renderer.listen(cloneEl, 'keyup', (ev: KeyboardEvent) => {\r\n      switch (ev.code) {\r\n        case 'Enter':\r\n          this.indexedDB\r\n            .getObjectStore('markdown_article', 'readwrite')\r\n            .add(new Folder(prtId, 'folder', (<HTMLInputElement> ev.target).value))\r\n            .subscribe(value => {\r\n              this.refreshArticles();\r\n              this.renderer.removeChild(parent, cloneEl);\r\n            });\r\n      }\r\n    });\r\n    this.renderer.appendChild(parent, cloneEl);\r\n    (<HTMLElement> cloneEl).querySelector('input').focus();\r\n  }\r\n\r\n  rename(): void {\r\n    const parent = (this.selectedNode && this.selectedNode.el.parentElement) ||\r\n      null;\r\n\r\n    const type = this.selectedNode.data.type;\r\n\r\n    const cloneEl = this.inputArea.cloneNode(true);\r\n\r\n    this.renderer.listen(cloneEl, 'keyup', (ev: KeyboardEvent) => {\r\n      switch (ev.code) {\r\n        case 'Enter':\r\n          const value = (<HTMLInputElement> ev.target).value;\r\n          this.selectedNode.data[type === 'folder' ? 'name' : 'title'] = value;\r\n          this.indexedDB\r\n            .getObjectStore('markdown_article', 'readwrite')\r\n            .update(this.selectedNode.data)\r\n            .subscribe(() => {\r\n              this.refreshArticles();\r\n              this.renderer.removeChild(parent, cloneEl);\r\n              this.selectedNode = null;\r\n            });\r\n      }\r\n    });\r\n    parent.replaceChild(cloneEl, this.selectedNode.el);\r\n    (<HTMLElement> cloneEl.lastChild).focus();\r\n  }\r\n\r\n  delete(): void {\r\n    const children = this.fileTree.recursionChildNodes(this.selectedNode.data.id);\r\n    this.indexedDB.getObjectStore('markdown_article', 'readwrite')\r\n      .deleteAll(...children.map(value => value.id), this.selectedNode.data.id)\r\n      .subscribe(value => this.refreshArticles());\r\n  }\r\n\r\n  close(): void {\r\n    console.log('close');\r\n  }\r\n\r\n  select(el: HTMLElement, node: TreeableNode): void {\r\n\r\n    if (this.selectedNode) {\r\n      if (this.selectedNode.el === el) {\r\n        this.selectedNode.el.classList.remove('fb-li_selected');\r\n        this.selectedNode = null;\r\n      } else {\r\n        el.classList.add('fb-li_selected');\r\n        this.selectedNode.el.classList.remove('fb-li_selected');\r\n        this.selectedNode = {el, data: node};\r\n      }\r\n    } else {\r\n      el.classList.add('fb-li_selected');\r\n      this.selectedNode = {el, data: node};\r\n    }\r\n    console.log(this.selectedNode);\r\n  }\r\n\r\n  open(el: HTMLElement, node: TreeableNode): void {\r\n    this._save(this.markdownService.currentFile.value);\r\n    this.markdownService.reinitialization(node.content);\r\n    this.markdownService.currentFile.next(node);\r\n  }\r\n\r\n  expanded(treeNode: TreeNodeComponent) {\r\n    const data = <Folder> treeNode.data.data;\r\n    data.isExpanded = treeNode.isExpanded;\r\n    this.indexedDB.getObjectStore('markdown_article', 'readwrite')\r\n      .update(data)\r\n      .subscribe(value => console.log(value));\r\n  }\r\n\r\n  private _save(data: TreeableNode) {\r\n    (data as Article).content = this.markdownService.originMd.value;\r\n    this.indexedDB\r\n      .getObjectStore('markdown_article', 'readwrite')\r\n      .update(data)\r\n      .subscribe(() => {\r\n        this.refreshArticles();\r\n        console.log('save success');\r\n      });\r\n  }\r\n  private refreshArticles(): Promise<any> {\r\n    return new Promise((resolve, reject) => {\r\n      this.indexedDB.getObjectStore('markdown_article', 'readwrite')\r\n        .getAll<any>()\r\n        .subscribe(value => {\r\n          if (value.type === IndexedDBEventType.COMPLETE) {\r\n            this.fileTree = new Tree(value.data);\r\n            resolve(value);\r\n          }\r\n        }, error => reject(error));\r\n    });\r\n  }\r\n}\r\n\r\nexport class Article implements TreeableNode {\r\n  static AUTHOR   = 'Author';\r\n  static TITLE    = 'Default Title';\r\n  static CONTENT  = '# Default Title';\r\n\r\n  id: number;\r\n  parentId: number;\r\n  type: string;\r\n  author: string;\r\n  title: string;\r\n  content: string;\r\n  createTime: Date;\r\n  lastModifiedTime: Date;\r\n\r\n  constructor(parentId: number  = -1,\r\n              type: string      = 'article',\r\n              author: string    = Article.AUTHOR,\r\n              title: string     = Article.TITLE,\r\n              content: string   = Article.CONTENT,\r\n  ) {\r\n    this.parentId         = parentId;\r\n    this.type             = type;\r\n    this.author           = author;\r\n    this.title            = title;\r\n    this.content          = content;\r\n    this.createTime       = new Date();\r\n    this.lastModifiedTime = this.createTime;\r\n  }\r\n}\r\n\r\nexport class Folder implements TreeableNode {\r\n  static NAME = 'folderName';\r\n\r\n  id: number;\r\n  parentId: number;\r\n  type: string;\r\n  name: string;\r\n  isExpanded: boolean;\r\n\r\n  constructor(parentId: number    = -1,\r\n              type: string        = 'folder',\r\n              name: string        = Folder.NAME,\r\n              isExpanded: boolean = true\r\n  ) {\r\n    this.parentId   = parentId;\r\n    this.type       = type;\r\n    this.name       = name;\r\n    this.isExpanded = isExpanded;\r\n  }\r\n}\r\n","module.exports = \".menu {\\r\\n  display: flex;\\r\\n  flex-direction: column;\\r\\n  height: 100%;\\r\\n  background-color: lightgray;\\r\\n}\\r\\n\\r\\n.mu-header {\\r\\n  flex: 0 0 30px;\\r\\n  background-color: rgba(0, 0, 0, 0.1);\\r\\n}\\r\\n\\r\\n.menu .mu-title {\\r\\n  line-height: 30px;\\r\\n  margin: 0 5px;\\r\\n}\\r\\n\\r\\n.mu-list {\\r\\n  flex: 1 1 auto;\\r\\n  width: 280px;\\r\\n  overflow: auto;\\r\\n}\\r\\n\\r\\n.mu-list ul {\\r\\n  list-style: none;\\r\\n  margin: 0 0 0 5px;\\r\\n  padding-left: 2px;\\r\\n}\\r\\n\\r\\n.mu-list li {\\r\\n  display: flex;\\r\\n  align-items: center;\\r\\n  box-sizing: border-box;\\r\\n  font-size: 12px;\\r\\n  padding: 10px;\\r\\n  margin: 3px;\\r\\n}\\r\\n\\r\\n.mu-li_hover:hover {\\r\\n  background-color: rgba(0, 0, 0, 0.1);\\r\\n}\\r\\n\\r\\n.mu-item {\\r\\n  display: flex;\\r\\n  flex-direction: column;\\r\\n  margin-left: 10px;\\r\\n}\\r\\n\\r\\n.mu-item-title {\\r\\n  font-size: 16px;\\r\\n}\\r\\n\\r\\n.mu-item-description {\\r\\n  font-size: 12px;\\r\\n  color: gray;\\r\\n}\\r\\n\\r\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInByb2plY3RzL25ncjItbWFya2Rvd24vc3JjL2xpYi9tZW51L21lbnUuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLGFBQWE7RUFDYixzQkFBc0I7RUFDdEIsWUFBWTtFQUNaLDJCQUEyQjtBQUM3Qjs7QUFFQTtFQUNFLGNBQWM7RUFDZCxvQ0FBb0M7QUFDdEM7O0FBRUE7RUFDRSxpQkFBaUI7RUFDakIsYUFBYTtBQUNmOztBQUNBO0VBQ0UsY0FBYztFQUNkLFlBQVk7RUFDWixjQUFjO0FBQ2hCOztBQUVBO0VBQ0UsZ0JBQWdCO0VBQ2hCLGlCQUFpQjtFQUNqQixpQkFBaUI7QUFDbkI7O0FBRUE7RUFDRSxhQUFhO0VBQ2IsbUJBQW1CO0VBQ25CLHNCQUFzQjtFQUN0QixlQUFlO0VBQ2YsYUFBYTtFQUNiLFdBQVc7QUFDYjs7QUFFQTtFQUNFLG9DQUFvQztBQUN0Qzs7QUFFQTtFQUNFLGFBQWE7RUFDYixzQkFBc0I7RUFDdEIsaUJBQWlCO0FBQ25COztBQUNBO0VBQ0UsZUFBZTtBQUNqQjs7QUFFQTtFQUNFLGVBQWU7RUFDZixXQUFXO0FBQ2IiLCJmaWxlIjoicHJvamVjdHMvbmdyMi1tYXJrZG93bi9zcmMvbGliL21lbnUvbWVudS5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLm1lbnUge1xyXG4gIGRpc3BsYXk6IGZsZXg7XHJcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcclxuICBoZWlnaHQ6IDEwMCU7XHJcbiAgYmFja2dyb3VuZC1jb2xvcjogbGlnaHRncmF5O1xyXG59XHJcblxyXG4ubXUtaGVhZGVyIHtcclxuICBmbGV4OiAwIDAgMzBweDtcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDAsIDAsIDAsIDAuMSk7XHJcbn1cclxuXHJcbi5tZW51IC5tdS10aXRsZSB7XHJcbiAgbGluZS1oZWlnaHQ6IDMwcHg7XHJcbiAgbWFyZ2luOiAwIDVweDtcclxufVxyXG4ubXUtbGlzdCB7XHJcbiAgZmxleDogMSAxIGF1dG87XHJcbiAgd2lkdGg6IDI4MHB4O1xyXG4gIG92ZXJmbG93OiBhdXRvO1xyXG59XHJcblxyXG4ubXUtbGlzdCB1bCB7XHJcbiAgbGlzdC1zdHlsZTogbm9uZTtcclxuICBtYXJnaW46IDAgMCAwIDVweDtcclxuICBwYWRkaW5nLWxlZnQ6IDJweDtcclxufVxyXG5cclxuLm11LWxpc3QgbGkge1xyXG4gIGRpc3BsYXk6IGZsZXg7XHJcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcclxuICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xyXG4gIGZvbnQtc2l6ZTogMTJweDtcclxuICBwYWRkaW5nOiAxMHB4O1xyXG4gIG1hcmdpbjogM3B4O1xyXG59XHJcblxyXG4ubXUtbGlfaG92ZXI6aG92ZXIge1xyXG4gIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMCwgMCwgMCwgMC4xKTtcclxufVxyXG5cclxuLm11LWl0ZW0ge1xyXG4gIGRpc3BsYXk6IGZsZXg7XHJcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcclxuICBtYXJnaW4tbGVmdDogMTBweDtcclxufVxyXG4ubXUtaXRlbS10aXRsZSB7XHJcbiAgZm9udC1zaXplOiAxNnB4O1xyXG59XHJcblxyXG4ubXUtaXRlbS1kZXNjcmlwdGlvbiB7XHJcbiAgZm9udC1zaXplOiAxMnB4O1xyXG4gIGNvbG9yOiBncmF5O1xyXG59XHJcbiJdfQ== */\"","module.exports = \"<div class=\\\"menu\\\">\\r\\n  <header class=\\\"mu-header\\\">\\r\\n    <span class=\\\"mu-title\\\">MENU</span>\\r\\n  </header>\\r\\n  <aside class=\\\"mu-list\\\">\\r\\n    <ul>\\r\\n      <li class=\\\"mu-li_hover\\\"\\r\\n          (click)=\\\"downloadMarkdown()\\\"\\r\\n      >\\r\\n        <i class=\\\"material-icons md-18 md-dark\\\">\\r\\n          cloud_download\\r\\n        </i>\\r\\n        <div class=\\\"mu-item\\\">\\r\\n          <span class=\\\"mu-item-title\\\">Download Markdown</span>\\r\\n          <span class=\\\"mu-item-description\\\">Download Markdown</span>\\r\\n        </div>\\r\\n      </li>\\r\\n      <li class=\\\"mu-li_hover\\\"\\r\\n          (click)=\\\"downloadHTML()\\\"\\r\\n      >\\r\\n        <i class=\\\"material-icons md-18 md-dark\\\">\\r\\n          cloud_download\\r\\n        </i>\\r\\n        <div class=\\\"mu-item\\\">\\r\\n          <span class=\\\"mu-item-title\\\">Download HTML</span>\\r\\n          <span class=\\\"mu-item-description\\\">Download HTML</span>\\r\\n        </div>\\r\\n      </li>\\r\\n      <li class=\\\"mu-li_hover\\\"\\r\\n          (click)=\\\"downloadPDF()\\\"\\r\\n      >\\r\\n        <i class=\\\"material-icons md-18 md-dark\\\">\\r\\n          cloud_download\\r\\n        </i>\\r\\n        <div class=\\\"mu-item\\\">\\r\\n          <span class=\\\"mu-item-title\\\">Download PDF (Disable)</span>\\r\\n          <span class=\\\"mu-item-description\\\">Download PDF</span>\\r\\n        </div>\\r\\n      </li>\\r\\n    </ul>\\r\\n  </aside>\\r\\n</div>\\r\\n\"","import { Component, OnInit } from '@angular/core';\r\nimport {Ngr2MarkdownService} from '../service/ngr2-markdown.service';\r\nimport {FileOperatorImpl} from '../core/fileOperator';\r\n\r\n@Component({\r\n  selector: 'nb-menu',\r\n  templateUrl: './menu.component.html',\r\n  styleUrls: ['./menu.component.css']\r\n})\r\nexport class MenuComponent implements OnInit {\r\n\r\n  private fileOperator: FileOperatorImpl;\r\n  constructor(private markdownService: Ngr2MarkdownService\r\n  ) {\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.fileOperator = new FileOperatorImpl();\r\n  }\r\n\r\n  downloadMarkdown() {\r\n    const unsubscribe = this.markdownService.observeMarkdown()\r\n      .subscribe(value => {\r\n        console.log(value);\r\n        const file = new Blob([value.Markdown.text], {type: 'text/plain'});\r\n        const dataUrl = this.fileOperator.toDataURLSync(file);\r\n        const anchor: HTMLAnchorElement = <HTMLAnchorElement> document.createElement('A');\r\n        anchor.download = 'Markdown.md';\r\n        anchor.href = dataUrl;\r\n        anchor.click();\r\n      });\r\n    unsubscribe.unsubscribe();\r\n  }\r\n\r\n  downloadHTML() {\r\n    const unsubscribe = this.markdownService.observeMarkdown()\r\n      .subscribe(value => {\r\n        const htmlWindow = window.open('', '');\r\n        document.head.querySelectorAll('meta, style').forEach(el => {\r\n          htmlWindow.document.head.innerHTML += el.outerHTML;\r\n        });\r\n        htmlWindow.document.body.innerHTML = `<article class=\"markdown-body\" style=\"font-size: 14px;height: auto;overflow: visible;\">`\r\n          + value.HTML.text\r\n          + `</article>`;\r\n        const html = htmlWindow.document.documentElement.innerHTML;\r\n        htmlWindow.close();\r\n\r\n        const file = new Blob([html], {type: 'text/html'});\r\n        const dataUrl = this.fileOperator.toDataURLSync(file);\r\n        const anchor: HTMLAnchorElement = <HTMLAnchorElement> document.createElement('A');\r\n        anchor.download = 'HTML.html';\r\n        anchor.href = dataUrl;\r\n        anchor.click();\r\n      });\r\n    unsubscribe.unsubscribe();\r\n  }\r\n\r\n  /**\r\n   * @deprecated\r\n   */\r\n  downloadPDF() {\r\n    const unsubscribe = this.markdownService.observeMarkdown()\r\n      .subscribe(value => {\r\n        const htmlWindow = window.open('', '');\r\n        document.head.querySelectorAll('meta, style').forEach(el => {\r\n          htmlWindow.document.head.innerHTML += el.outerHTML;\r\n        });\r\n        htmlWindow.document.body.innerHTML = `<article class=\"markdown-body\" style=\"font-size: 14px;height: auto;overflow: visible;\">`\r\n          + value.HTML.text\r\n          + `</article>`;\r\n        htmlWindow.print();\r\n        htmlWindow.close();\r\n      });\r\n    unsubscribe.unsubscribe();\r\n  }\r\n}\r\n","module.exports = \".main-panel {\\r\\n  position: relative;\\r\\n  display: flex;\\r\\n  flex-direction: column;\\r\\n  flex: 1 1 auto;\\r\\n  /* 内边距15px */\\r\\n  box-sizing: border-box;\\r\\n  /*padding: 15px;*/\\r\\n}\\r\\n\\r\\n/* 预览框 */\\r\\n\\r\\n.markdown-preview {\\r\\n  flex: 1;\\r\\n  overflow-y: auto;\\r\\n  box-sizing: border-box;\\r\\n  margin: 0;\\r\\n  padding: 20px;\\r\\n  min-width: 200px;\\r\\n  height: 100%;\\r\\n  background-color: white;\\r\\n}\\r\\n\\r\\n.markdown-body {\\r\\n  position: relative;\\r\\n  margin-bottom: 120px;\\r\\n}\\r\\n\\r\\n/* 编辑框 */\\r\\n\\r\\n.editor {\\r\\n  flex: 1;\\r\\n  overflow-y: auto;\\r\\n  box-sizing: border-box;\\r\\n  margin: 0 auto;\\r\\n  min-width: 200px;\\r\\n  height: auto;\\r\\n  display: flex;\\r\\n  flex-direction: column;\\r\\n}\\r\\n\\r\\n.content-container {\\r\\n  display: flex;\\r\\n  flex-direction: row;\\r\\n}\\r\\n\\r\\n/* 侧边栏目录 */\\r\\n\\r\\n.side-toc-container {\\r\\n  flex: 0 auto;\\r\\n  max-width: 200px;\\r\\n}\\r\\n\\r\\n.tool-bar {\\r\\n  flex: 0 0 25px;\\r\\n  background-color: lightgray;\\r\\n}\\r\\n\\r\\n.content-panel {\\r\\n  flex: 1 1 auto;\\r\\n}\\r\\n\\r\\n.status-bar-wrapper {\\r\\n  flex: 0 0 20px;\\r\\n  background-color: gray;\\r\\n}\\r\\n\\r\\n.file-browser-wrapper {\\r\\n  flex: 0 0 200px;\\r\\n  background-color: dimgray;\\r\\n}\\r\\n\\r\\n.control-bar {\\r\\n  overflow: auto;\\r\\n  flex: 0 0 10px;\\r\\n  background-color: antiquewhite;\\r\\n}\\r\\n\\r\\n.menu-wrapper {\\r\\n  flex: 0 0 280px;\\r\\n  background-color: lightslategray;\\r\\n}\\r\\n\\r\\n/* 设置滚动条样式 */\\r\\n\\r\\n::-webkit-scrollbar {\\r\\n  width: 6px;\\r\\n  height: 6px;\\r\\n  background-color: transparent;\\r\\n}\\r\\n\\r\\n::-webkit-scrollbar-thumb {\\r\\n  background-color: darkgray;\\r\\n}\\r\\n\\r\\n\\r\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInByb2plY3RzL25ncjItbWFya2Rvd24vc3JjL2xpYi9uZ3IyLW1hcmtkb3duLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxrQkFBa0I7RUFDbEIsYUFBYTtFQUNiLHNCQUFzQjtFQUN0QixjQUFjO0VBQ2QsWUFBWTtFQUNaLHNCQUFzQjtFQUN0QixpQkFBaUI7QUFDbkI7O0FBRUEsUUFBUTs7QUFDUjtFQUNFLE9BQU87RUFDUCxnQkFBZ0I7RUFDaEIsc0JBQXNCO0VBQ3RCLFNBQVM7RUFDVCxhQUFhO0VBQ2IsZ0JBQWdCO0VBQ2hCLFlBQVk7RUFDWix1QkFBdUI7QUFDekI7O0FBRUE7RUFDRSxrQkFBa0I7RUFDbEIsb0JBQW9CO0FBQ3RCOztBQUVBLFFBQVE7O0FBQ1I7RUFDRSxPQUFPO0VBQ1AsZ0JBQWdCO0VBQ2hCLHNCQUFzQjtFQUN0QixjQUFjO0VBQ2QsZ0JBQWdCO0VBQ2hCLFlBQVk7RUFDWixhQUFhO0VBQ2Isc0JBQXNCO0FBQ3hCOztBQUVBO0VBQ0UsYUFBYTtFQUNiLG1CQUFtQjtBQUNyQjs7QUFFQSxVQUFVOztBQUNWO0VBQ0UsWUFBWTtFQUNaLGdCQUFnQjtBQUNsQjs7QUFFQTtFQUNFLGNBQWM7RUFDZCwyQkFBMkI7QUFDN0I7O0FBRUE7RUFDRSxjQUFjO0FBQ2hCOztBQUVBO0VBQ0UsY0FBYztFQUNkLHNCQUFzQjtBQUN4Qjs7QUFFQTtFQUNFLGVBQWU7RUFDZix5QkFBeUI7QUFDM0I7O0FBRUE7RUFDRSxjQUFjO0VBQ2QsY0FBYztFQUNkLDhCQUE4QjtBQUNoQzs7QUFFQTtFQUNFLGVBQWU7RUFDZixnQ0FBZ0M7QUFDbEM7O0FBR0EsWUFBWTs7QUFDWjtFQUNFLFVBQVU7RUFDVixXQUFXO0VBQ1gsNkJBQTZCO0FBQy9COztBQUVBO0VBQ0UsMEJBQTBCO0FBQzVCIiwiZmlsZSI6InByb2plY3RzL25ncjItbWFya2Rvd24vc3JjL2xpYi9uZ3IyLW1hcmtkb3duLmNvbXBvbmVudC5jc3MiLCJzb3VyY2VzQ29udGVudCI6WyIubWFpbi1wYW5lbCB7XHJcbiAgcG9zaXRpb246IHJlbGF0aXZlO1xyXG4gIGRpc3BsYXk6IGZsZXg7XHJcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcclxuICBmbGV4OiAxIDEgYXV0bztcclxuICAvKiDlhoXovrnot50xNXB4ICovXHJcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcclxuICAvKnBhZGRpbmc6IDE1cHg7Ki9cclxufVxyXG5cclxuLyog6aKE6KeI5qGGICovXHJcbi5tYXJrZG93bi1wcmV2aWV3IHtcclxuICBmbGV4OiAxO1xyXG4gIG92ZXJmbG93LXk6IGF1dG87XHJcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcclxuICBtYXJnaW46IDA7XHJcbiAgcGFkZGluZzogMjBweDtcclxuICBtaW4td2lkdGg6IDIwMHB4O1xyXG4gIGhlaWdodDogMTAwJTtcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiB3aGl0ZTtcclxufVxyXG5cclxuLm1hcmtkb3duLWJvZHkge1xyXG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcclxuICBtYXJnaW4tYm90dG9tOiAxMjBweDtcclxufVxyXG5cclxuLyog57yW6L6R5qGGICovXHJcbi5lZGl0b3Ige1xyXG4gIGZsZXg6IDE7XHJcbiAgb3ZlcmZsb3cteTogYXV0bztcclxuICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xyXG4gIG1hcmdpbjogMCBhdXRvO1xyXG4gIG1pbi13aWR0aDogMjAwcHg7XHJcbiAgaGVpZ2h0OiBhdXRvO1xyXG4gIGRpc3BsYXk6IGZsZXg7XHJcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcclxufVxyXG5cclxuLmNvbnRlbnQtY29udGFpbmVyIHtcclxuICBkaXNwbGF5OiBmbGV4O1xyXG4gIGZsZXgtZGlyZWN0aW9uOiByb3c7XHJcbn1cclxuXHJcbi8qIOS+p+i+ueagj+ebruW9lSAqL1xyXG4uc2lkZS10b2MtY29udGFpbmVyIHtcclxuICBmbGV4OiAwIGF1dG87XHJcbiAgbWF4LXdpZHRoOiAyMDBweDtcclxufVxyXG5cclxuLnRvb2wtYmFyIHtcclxuICBmbGV4OiAwIDAgMjVweDtcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiBsaWdodGdyYXk7XHJcbn1cclxuXHJcbi5jb250ZW50LXBhbmVsIHtcclxuICBmbGV4OiAxIDEgYXV0bztcclxufVxyXG5cclxuLnN0YXR1cy1iYXItd3JhcHBlciB7XHJcbiAgZmxleDogMCAwIDIwcHg7XHJcbiAgYmFja2dyb3VuZC1jb2xvcjogZ3JheTtcclxufVxyXG5cclxuLmZpbGUtYnJvd3Nlci13cmFwcGVyIHtcclxuICBmbGV4OiAwIDAgMjAwcHg7XHJcbiAgYmFja2dyb3VuZC1jb2xvcjogZGltZ3JheTtcclxufVxyXG5cclxuLmNvbnRyb2wtYmFyIHtcclxuICBvdmVyZmxvdzogYXV0bztcclxuICBmbGV4OiAwIDAgMTBweDtcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiBhbnRpcXVld2hpdGU7XHJcbn1cclxuXHJcbi5tZW51LXdyYXBwZXIge1xyXG4gIGZsZXg6IDAgMCAyODBweDtcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiBsaWdodHNsYXRlZ3JheTtcclxufVxyXG5cclxuXHJcbi8qIOiuvue9rua7muWKqOadoeagt+W8jyAqL1xyXG46Oi13ZWJraXQtc2Nyb2xsYmFyIHtcclxuICB3aWR0aDogNnB4O1xyXG4gIGhlaWdodDogNnB4O1xyXG4gIGJhY2tncm91bmQtY29sb3I6IHRyYW5zcGFyZW50O1xyXG59XHJcblxyXG46Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iIHtcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiBkYXJrZ3JheTtcclxufVxyXG5cclxuIl19 */\"","module.exports = \"<div class=\\\"main-panel\\\"\\r\\n     [style.height]=\\\"_options.height\\\"\\r\\n     nbDragAndDrop\\r\\n>\\r\\n  <nb-tool-bar class=\\\"tool-bar\\\"\\r\\n  ></nb-tool-bar>\\r\\n  <div class=\\\"content-panel content-container\\\"\\r\\n       nbDragAndDrop\\r\\n  >\\r\\n    <nb-file-browser class=\\\"file-browser-wrapper\\\"\\r\\n    >\\r\\n    </nb-file-browser>\\r\\n    <nb-edit-box *ngIf=\\\"_options.mode === 'edit'\\\"\\r\\n                 [ngClass]=\\\"'editor'\\\"\\r\\n    >\\r\\n    </nb-edit-box>\\r\\n    <nb-control-bar class=\\\"control-bar\\\"\\r\\n    >\\r\\n    </nb-control-bar>\\r\\n    <!--disable: nbSyncScroll-->\\r\\n    <article #markdownBody\\r\\n             class=\\\"markdown-preview\\\"\\r\\n             nbSyncScroll\\r\\n             [syncScrollInfo]=\\\"syncScroll\\\"\\r\\n    >\\r\\n      <div [ngClass]=\\\"[_options.bodyClassName]\\\"\\r\\n           [innerHTML]=\\\"_html | safe:'html'\\\"\\r\\n      >\\r\\n      </div>\\r\\n    </article>\\r\\n    <nb-menu class=\\\"menu-wrapper\\\"\\r\\n    >\\r\\n    </nb-menu>\\r\\n  </div>\\r\\n  <nb-status-bar class=\\\"status-bar-wrapper\\\"\\r\\n  ></nb-status-bar>\\r\\n</div>\\r\\n\"","import {\r\n  Component, ElementRef,\r\n  Input, OnInit, ViewChild,\r\n  ViewEncapsulation\r\n} from '@angular/core';\r\nimport {EditorOption, Ngr2MarkdownService} from './service/ngr2-markdown.service';\r\nimport {fromEvent} from 'rxjs';\r\nimport {distinctUntilChanged, filter, map} from 'rxjs/operators';\r\nimport {SyncScroll} from './core/syncScroll';\r\n\r\n@Component({\r\n  selector: 'nb-ngr2-markdown',\r\n  templateUrl: './ngr2-markdown.component.html',\r\n  styleUrls: [\r\n    './ngr2-markdown.component.css',\r\n  ],\r\n  encapsulation: ViewEncapsulation.None\r\n})\r\nexport class Ngr2MarkdownComponent implements OnInit {\r\n  @ViewChild('markdownBody', {\r\n    read: ElementRef\r\n  }) markdownBody: ElementRef;\r\n  /**\r\n   * markdown转换后的html文本\r\n   */\r\n  _html: string;\r\n  /**\r\n   * 配置参数\r\n   */\r\n  _options: EditorOption;\r\n\r\n  syncScroll: SyncScroll;\r\n\r\n  @Input()\r\n  set markdown(value: string) {\r\n    this.markdownService.updateMarkdown(value);\r\n  }\r\n  @Input()\r\n  set options(value: EditorOption) {\r\n    this._options = EditorOption.instanceOf(value);\r\n  }\r\n\r\n  constructor(private markdownService: Ngr2MarkdownService\r\n  ) {\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.syncScroll = new SyncScroll(\r\n      this.markdownBody.nativeElement,\r\n      'pre',\r\n      (node, index) => index + '-' + ((node as HTMLElement).tagName.charCodeAt(1) - 48)\r\n    );\r\n    this.syncScroll.syncScrollByHeading();\r\n\r\n    this.markdownService.observeMarkdown()\r\n      .subscribe(value => {\r\n        // 更新innerHTML\r\n        this._html = value.html;\r\n        // this.updateHeadingsInfo();\r\n        // 重新初始化一些需要视图渲染结束才能获取的对象的值\r\n        // this.reinitialization();\r\n        setTimeout(() => {\r\n          this.syncScroll.updateHeadingsInfo();\r\n        });\r\n      });\r\n\r\n    fromEvent(this.markdownBody.nativeElement, 'scroll')\r\n      .pipe(\r\n        filter(() => this.syncScroll.headingsInfo && this.syncScroll.headingsInfo.length > 0),\r\n        map(() => this.syncScroll.currentHeading()),\r\n        distinctUntilChanged()\r\n      )\r\n      .subscribe(value => {\r\n      });\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { Ngr2MarkdownComponent } from './ngr2-markdown.component';\r\nimport { SideTocComponent } from './side-toc/side-toc.component';\r\nimport { HTMLPipePipe } from './pipe/htmlpipe.pipe';\r\nimport {BrowserModule} from '@angular/platform-browser';\r\nimport { MdPipe } from './pipe/md.pipe';\r\nimport { ToolBarComponent } from './tool-bar/tool-bar.component';\r\nimport { EditBoxComponent } from './edit-box/edit-box.component';\r\nimport { FileBrowserComponent } from './file-browser/file-browser.component';\r\nimport { StatusBarComponent } from './status-bar/status-bar.component';\r\nimport { ControlBarComponent } from './control-bar/control-bar.component';\r\nimport { MenuComponent } from './menu/menu.component';\r\nimport { DragAndDropDirective } from './drag-and-drop.directive';\r\nimport { TreeComponent } from './tree/tree/tree.component';\r\nimport { TreeNodeComponent } from './tree/tree-node/tree-node.component';\r\nimport { TreeNodeDefDirective, TreeNodeOutletDirective } from './tree/tree-node-directive/tree-node-def.directive';\r\nimport {TreeNodeToggleDirective} from './tree/tree-node-directive/tree-node-toggle.directive';\r\nimport { SyncScrollDirective } from './sync-scroll/sync-scroll.directive';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    Ngr2MarkdownComponent,\r\n    SideTocComponent,\r\n    HTMLPipePipe,\r\n    MdPipe,\r\n    ToolBarComponent,\r\n    EditBoxComponent,\r\n    FileBrowserComponent,\r\n    StatusBarComponent,\r\n    ControlBarComponent,\r\n    MenuComponent,\r\n    DragAndDropDirective,\r\n    TreeComponent,\r\n    TreeNodeComponent,\r\n    TreeNodeDefDirective,\r\n    TreeNodeOutletDirective,\r\n    TreeNodeToggleDirective,\r\n    SyncScrollDirective\r\n  ],\r\n  imports: [\r\n    BrowserModule\r\n  ],\r\n  exports: [\r\n    Ngr2MarkdownComponent,\r\n    SideTocComponent,\r\n    MdPipe\r\n  ]\r\n})\r\nexport class Ngr2MarkdownModule { }\r\n","import { Pipe, PipeTransform } from '@angular/core';\r\nimport {DomSanitizer, SafeHtml, SafeUrl} from '@angular/platform-browser';\r\n\r\n@Pipe({\r\n  name: 'safe'\r\n})\r\nexport class HTMLPipePipe implements PipeTransform {\r\n\r\n  constructor(private domSanitizer: DomSanitizer) {\r\n  }\r\n\r\n  /**\r\n   * use DomSanitizer allow insert outside HTML\r\n   * 使用DomSanitizer允许插入外部的HTML\r\n   * @param value - html content html内容\r\n   * @param args = 第一个参数是内容类型`html/url` 默认为 `html`\r\n   * @return - transformed html content html变换后的内容\r\n   */\r\n  transform(value: any, ...args: any[]): SafeHtml | SafeUrl {\r\n    const type = args[0];\r\n    switch (type) {\r\n      case 'html':\r\n        return this.domSanitizer.bypassSecurityTrustHtml(value);\r\n      case 'url':\r\n        return this.domSanitizer.bypassSecurityTrustUrl(value);\r\n      default:\r\n        return this.domSanitizer.bypassSecurityTrustHtml(value);\r\n    }\r\n  }\r\n\r\n}\r\n","import { Pipe, PipeTransform } from '@angular/core';\r\nimport {Ngr2MarkdownService} from '../service/ngr2-markdown.service';\r\n\r\n@Pipe({\r\n  name: 'md'\r\n})\r\nexport class MdPipe implements PipeTransform {\r\n\r\n  constructor(private markdownService: Ngr2MarkdownService) {\r\n  }\r\n\r\n  transform(value: string, args?: any): any {\r\n    return this.markdownService.render(value, {anchor: false});\r\n  }\r\n\r\n}\r\n","import {Injectable} from '@angular/core';\r\nimport * as MarkdownIt from 'markdown-it/lib/index';\r\nimport {BehaviorSubject, Observable, Observer} from 'rxjs';\r\nimport {MarkdownImpl, MarkdownOptionImpl} from '../core/markdown/markdown';\r\nimport {FileOperatorImpl} from '../core/fileOperator';\r\nimport {map} from 'rxjs/operators';\r\nimport {TextParser} from '../utils/textParser';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class Ngr2MarkdownService {\r\n\r\n  /**\r\n   * 接收Markdown源文本\r\n   */\r\n  originMd: BehaviorSubject<string> = new BehaviorSubject<string>('');\r\n  private resetMd: BehaviorSubject<string> = new BehaviorSubject<string>('');\r\n  /**\r\n   * 观察`originMd`通过`render`方法渲染出的HTML\r\n   */\r\n  private renderMd: BehaviorSubject<MarkdownContent> = new BehaviorSubject(null);\r\n  private _md: MarkdownImpl;\r\n  /**\r\n   * 当前浏览的标题的Subject, BehaviorSubject可支持多播(在多处订阅)\r\n   */\r\n  currentHeading: BehaviorSubject<string> = new BehaviorSubject<string>(null);\r\n  /**\r\n   * @deprecated\r\n   */\r\n  currentContent: BehaviorSubject<{md: string, html: string}> = new BehaviorSubject<{md: string, html: string}>({md: '', html: ''});\r\n  /**\r\n   * 发送目录信息的Subject\r\n   */\r\n  TOCInfo: BehaviorSubject<TOCItem> = new BehaviorSubject<TOCItem>(null);\r\n  syncScroll: BehaviorSubject<any> = new BehaviorSubject<any>(null);\r\n  currentFile: BehaviorSubject<any> = new BehaviorSubject<any>(null);\r\n\r\n  constructor() {\r\n    this._md = new MarkdownImpl();\r\n    this._md.use(this.anchor)\r\n      .subscribe((value: Array<any>) => {\r\n        const infoList = value.map((item) => {\r\n          return new TOCItem(item.content, item.indentLevel);\r\n        });\r\n        const root = new TOCItem('root', 0);\r\n        let TOCInfo = root;\r\n        for (let i = 0; i < infoList.length; i++) {\r\n          while (TOCInfo && TOCInfo.indentLevel >= infoList[i].indentLevel) {\r\n            TOCInfo = TOCInfo.parent;\r\n          }\r\n          infoList[i].parent = TOCInfo;\r\n          TOCInfo.children.push(infoList[i]);\r\n          TOCInfo = infoList[i];\r\n        }\r\n        this.TOCInfo.next(root);\r\n      });\r\n\r\n    this.originMd\r\n      .pipe(\r\n        map(mdText => {\r\n          const html = this.render(mdText);\r\n          return {\r\n            md:   mdText || null,\r\n            html,\r\n            Markdown: TextParser.parseMD(mdText),\r\n            HTML: TextParser.parseHTML(html)\r\n          };\r\n        })\r\n      ).subscribe(this.renderMd);\r\n\r\n    this.resetMd\r\n      .subscribe(this.originMd);\r\n  }\r\n\r\n  /**\r\n   * 重置markdown文本\r\n   * @param md\r\n   */\r\n  reinitialization(md: string): void {\r\n    if (!md) { return; }\r\n    this.resetMd.next(md);\r\n  }\r\n\r\n  /**\r\n   * markdown文本重置后, 发出消息\r\n   */\r\n  observerResetMarkdown(): Observable<string> {\r\n    return this.resetMd;\r\n  }\r\n\r\n  /**\r\n   * 更新markdown文本, 用于实时预览功能\r\n   * @param md\r\n   */\r\n  updateMarkdown(md: string | Observable<string>): void {\r\n    if (!md) { return; }\r\n\r\n    if (md instanceof Observable) {\r\n      md.subscribe(this.originMd);\r\n    } else {\r\n      this.originMd.next(md);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * markdown文本更新后, 发出消息\r\n   */\r\n  observeMarkdown(): Observable<MarkdownContent> {\r\n    return this.renderMd;\r\n  }\r\n\r\n  /**\r\n   * 将Markdown原始文本渲染成HTML格式\r\n   * @param markdown\r\n   * @param options\r\n   */\r\n  render(markdown: string, options?: MarkdownOptionImpl): string {\r\n    if (!markdown) {\r\n      markdown = '';\r\n    }\r\n    const html = this._md.render(markdown, options);\r\n    return html;\r\n  }\r\n\r\n  /**\r\n   * 设置当前浏览的标题\r\n   * @param heading - 标题标签的id\r\n   */\r\n  setCurrentHeading(heading: string): void {\r\n    if (this.currentHeading.getValue() !== heading) {\r\n      this.currentHeading.next(heading);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 将当前显示的内容转换成`data:`url\r\n   * @param type - `markdown`/`html`: 要转换的内容\r\n   */\r\n  currentContentToDataUrl(type: string): FileOperatorImpl {\r\n    const fileOperator = new FileOperatorImpl();\r\n    // 兼容ie11-10, ie10不支持File对象的构造函数, 无法新建File对象, 故使用Blob\r\n    let file: Blob | File;\r\n    switch (type) {\r\n      case 'markdown':\r\n        file = new Blob([this.currentContent.getValue().md], {type: 'text/plain'});\r\n        break;\r\n      case `html`:\r\n        file = new Blob([this.currentContent.getValue().html], {type: 'text/html'});\r\n        break;\r\n      default:\r\n        file = new Blob(['null'], {type: 'text/html'});\r\n        break;\r\n    }\r\n    fileOperator.toDataURLSync(file);\r\n    return fileOperator;\r\n  }\r\n\r\n  /**\r\n   * Plugin: anchor\r\n   * 这个方法向类型为heading_open的token添加id, 用于锚点定位\r\n   * @param md - MarkdownIt instance\r\n   * @param observer - use to push info\r\n   */\r\n  private anchor(md: MarkdownIt, observer: Observer<Array<any>>) {\r\n    md.core.ruler.push('anchor', (state => {\r\n      const infoList: Array<any> = [];\r\n      let index = 0;\r\n      state.tokens.forEach((token) => {\r\n        if (token.type === 'heading_open') {\r\n          token.attrJoin('id', index++ + '-' + token.markup.length);\r\n          infoList.push({\r\n            content: token.attrGet('id'),\r\n            indentLevel: token.markup.length\r\n          });\r\n        }\r\n      });\r\n      observer.next(infoList);\r\n    }));\r\n  }\r\n}\r\n\r\nexport interface MarkdownContent {\r\n  md: string;\r\n  html?: string;\r\n  Markdown?: {\r\n    text:   string,\r\n    bytes:  number,\r\n    words:  number,\r\n    lines:  number\r\n  };\r\n  HTML?: {\r\n    text:       string,\r\n    characters: number,\r\n    words:      number,\r\n    paragraphs: number\r\n  };\r\n}\r\n/**\r\n * 目录(TOC)生成的位置\r\n * start: TOC在内容左边\r\n * end: 右边\r\n */\r\ntype TocPos = 'left' | 'right';\r\n/**\r\n * 模式\r\n * preview: 预览模式\r\n * edit: 编辑模式\r\n */\r\ntype Mode = 'preview' | 'edit';\r\n\r\nexport class EditorOption {\r\n  static MODE: Mode = 'edit';\r\n  static ANCHOR = false;\r\n  static TOc = false;\r\n  static TOOL_BAR = false;\r\n  static DIRECTION: TocPos = 'left';\r\n  static HEIGHT = '800px';\r\n  static THEME_COLOR = '#3f51b5';\r\n  static BODY_CLASS_NAME = 'markdown-body';\r\n\r\n  mode: Mode;\r\n  anchor: boolean;\r\n  TOC: boolean;\r\n  toolBar: boolean;\r\n  direction: TocPos;\r\n  /**\r\n   * container height property\r\n   */\r\n  height: string;\r\n  /**\r\n   * container toc active color property\r\n   */\r\n  themeColor: string;\r\n  bodyClassName: string;\r\n\r\n  constructor(mode: Mode            = EditorOption.MODE,\r\n            anchor: boolean         = EditorOption.ANCHOR,\r\n              TOC: boolean          = EditorOption.TOc,\r\n              toolBar: boolean      = EditorOption.TOOL_BAR,\r\n              direction: TocPos     = EditorOption.DIRECTION,\r\n              height: string        = EditorOption.HEIGHT,\r\n              themeColor: string    = EditorOption.THEME_COLOR,\r\n              bodyClassName: string = EditorOption.BODY_CLASS_NAME\r\n  ) {\r\n    this.mode =           mode;\r\n    this.anchor =         anchor;\r\n    this.TOC =            TOC;\r\n    this.toolBar =        toolBar;\r\n    this.direction =      direction;\r\n    this.height =         height;\r\n    this.themeColor =     themeColor;\r\n    this.bodyClassName =  bodyClassName;\r\n  }\r\n\r\n  static instanceOf(value: EditorOption) {\r\n    return new EditorOption(\r\n      value.mode          || EditorOption.MODE,\r\n      value.anchor        || EditorOption.ANCHOR,\r\n      value.TOC           || EditorOption.TOc,\r\n      value.toolBar       || EditorOption.TOOL_BAR,\r\n      value.direction     || EditorOption.DIRECTION,\r\n      value.height        || EditorOption.HEIGHT,\r\n      value.themeColor    || EditorOption.THEME_COLOR,\r\n      value.bodyClassName || EditorOption.BODY_CLASS_NAME,\r\n    );\r\n  }\r\n}\r\n\r\nexport class TOCItem {\r\n  content: string;\r\n  indentLevel: number;\r\n  parent: TOCItem;\r\n  children: Array<TOCItem>;\r\n\r\n  constructor(content: string, indentLevel: number) {\r\n    this.content      = content;\r\n    this.indentLevel  = indentLevel;\r\n    this.children     = new Array<TOCItem>();\r\n  }\r\n}\r\n","module.exports = \".side-anchor-toc {\\r\\n  display: flex;\\r\\n  flex-direction: column;\\r\\n  font-size: 14px;\\r\\n  margin: 0 auto;\\r\\n  padding: 10px;\\r\\n  color: gray;\\r\\n}\\r\\n\\r\\n.side-anchor-toc a {\\r\\n  color: dimgray;\\r\\n}\\r\\n\\r\\n.nav {\\r\\n  margin: 0;\\r\\n}\\r\\n\\r\\n.nav-item {\\r\\n  line-height: 1.8;\\r\\n  cursor: pointer;\\r\\n}\\r\\n\\r\\n.nav-item-active {\\r\\n\\r\\n}\\r\\n\\r\\n.nav-item-link {\\r\\n  text-decoration: none;\\r\\n  outline: none;\\r\\n}\\r\\n\\r\\n.item-level-1 {\\r\\n\\r\\n}\\r\\n\\r\\n.item-level-2 {\\r\\n\\r\\n}\\r\\n\\r\\n.item-level-3 {\\r\\n\\r\\n}\\r\\n\\r\\n.item-level-4 {\\r\\n\\r\\n}\\r\\n\\r\\n.item-level-5 {\\r\\n\\r\\n}\\r\\n\\r\\n.item-level-6 {\\r\\n\\r\\n}\\r\\n\\r\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInByb2plY3RzL25ncjItbWFya2Rvd24vc3JjL2xpYi9zaWRlLXRvYy9zaWRlLXRvYy5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsYUFBYTtFQUNiLHNCQUFzQjtFQUN0QixlQUFlO0VBQ2YsY0FBYztFQUNkLGFBQWE7RUFDYixXQUFXO0FBQ2I7O0FBRUE7RUFDRSxjQUFjO0FBQ2hCOztBQUVBO0VBQ0UsU0FBUztBQUNYOztBQUVBO0VBQ0UsZ0JBQWdCO0VBQ2hCLGVBQWU7QUFDakI7O0FBRUE7O0FBRUE7O0FBRUE7RUFDRSxxQkFBcUI7RUFDckIsYUFBYTtBQUNmOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBIiwiZmlsZSI6InByb2plY3RzL25ncjItbWFya2Rvd24vc3JjL2xpYi9zaWRlLXRvYy9zaWRlLXRvYy5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLnNpZGUtYW5jaG9yLXRvYyB7XHJcbiAgZGlzcGxheTogZmxleDtcclxuICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xyXG4gIGZvbnQtc2l6ZTogMTRweDtcclxuICBtYXJnaW46IDAgYXV0bztcclxuICBwYWRkaW5nOiAxMHB4O1xyXG4gIGNvbG9yOiBncmF5O1xyXG59XHJcblxyXG4uc2lkZS1hbmNob3ItdG9jIGEge1xyXG4gIGNvbG9yOiBkaW1ncmF5O1xyXG59XHJcblxyXG4ubmF2IHtcclxuICBtYXJnaW46IDA7XHJcbn1cclxuXHJcbi5uYXYtaXRlbSB7XHJcbiAgbGluZS1oZWlnaHQ6IDEuODtcclxuICBjdXJzb3I6IHBvaW50ZXI7XHJcbn1cclxuXHJcbi5uYXYtaXRlbS1hY3RpdmUge1xyXG5cclxufVxyXG5cclxuLm5hdi1pdGVtLWxpbmsge1xyXG4gIHRleHQtZGVjb3JhdGlvbjogbm9uZTtcclxuICBvdXRsaW5lOiBub25lO1xyXG59XHJcblxyXG4uaXRlbS1sZXZlbC0xIHtcclxuXHJcbn1cclxuXHJcbi5pdGVtLWxldmVsLTIge1xyXG5cclxufVxyXG5cclxuLml0ZW0tbGV2ZWwtMyB7XHJcblxyXG59XHJcblxyXG4uaXRlbS1sZXZlbC00IHtcclxuXHJcbn1cclxuXHJcbi5pdGVtLWxldmVsLTUge1xyXG5cclxufVxyXG5cclxuLml0ZW0tbGV2ZWwtNiB7XHJcblxyXG59XHJcbiJdfQ== */\"","module.exports = \"<aside class=\\\"side-anchor-toc\\\">\\r\\n  <ol class=\\\"nav\\\">\\r\\n    <li *ngFor=\\\"let TOCItem of TOCInfo.children\\\"\\r\\n        [ngClass]=\\\"['item-level-' + TOCItem.indentLevel, 'nav-item', 'nav-item-active']\\\"\\r\\n    >\\r\\n      <a [href]=\\\"'#' + TOCItem.content\\\"\\r\\n         [ngClass]=\\\"['nav-item-link']\\\"\\r\\n         [ngStyle]=\\\"{'color': TOCItem.content === currentHeading ? themeColor : ''}\\\"\\r\\n      >\\r\\n        <span>{{ TOCItem.content }}</span>\\r\\n      </a>\\r\\n      <ol class=\\\"nav\\\">\\r\\n        <li *ngFor=\\\"let subItem of TOCItem.children\\\"\\r\\n            [ngClass]=\\\"['item-level-' + subItem.indentLevel, 'nav-item', 'nav-item-active']\\\"\\r\\n        >\\r\\n          <a [href]=\\\"'#' + subItem.content\\\"\\r\\n             [ngClass]=\\\"['nav-item-link']\\\"\\r\\n             [ngStyle]=\\\"{'color': subItem.content === currentHeading ? themeColor : ''}\\\"\\r\\n          >\\r\\n            <span>{{ subItem.content }}</span>\\r\\n          </a>\\r\\n        </li>\\r\\n      </ol>\\r\\n    </li>\\r\\n  </ol>\\r\\n</aside>\\r\\n\"","import {Component, Input, OnInit} from '@angular/core';\r\nimport {Ngr2MarkdownService, TOCItem} from '../service/ngr2-markdown.service';\r\n\r\n@Component({\r\n  selector: 'nb-side-toc',\r\n  templateUrl: './side-toc.component.html',\r\n  styleUrls: ['./side-toc.component.css']\r\n})\r\nexport class SideTocComponent implements OnInit {\r\n  @Input() currentHeading: string;\r\n  @Input() themeColor = '#3f51b5';\r\n  TOCInfo: TOCItem;\r\n  constructor(\r\n    private markdownService: Ngr2MarkdownService\r\n  ) {\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.markdownService.currentHeading.subscribe({\r\n      next: (value => {\r\n        this.currentHeading = value;\r\n      })\r\n    });\r\n    this.markdownService.TOCInfo.subscribe({\r\n      next: (value => {\r\n        this.TOCInfo = value;\r\n      })\r\n    });\r\n  }\r\n}\r\n","module.exports = \".status-bar {\\r\\n  display: flex;\\r\\n  /*justify-content: space-between;*/\\r\\n  font-size: 10px;\\r\\n  background-color: #007acc;\\r\\n  color: white;\\r\\n  height: 100%;\\r\\n}\\r\\n\\r\\n.status-bar_panel {\\r\\n  line-height: 20px;\\r\\n}\\r\\n\\r\\n.sb-file_browser {\\r\\n  flex: 0 0 200px;\\r\\n}\\r\\n\\r\\n.sb-edit_box {\\r\\n  flex: 1 1 auto;\\r\\n}\\r\\n\\r\\n.sb-control_bar {\\r\\n  flex: 0 0 10px;\\r\\n}\\r\\n\\r\\n.sb-preview_box {\\r\\n  flex: 1 1 auto;\\r\\n}\\r\\n\\r\\n.sb-menu {\\r\\n  flex: 0 0 280px;\\r\\n}\\r\\n\\r\\n.status-bar_panel-name {\\r\\n}\\r\\n\\r\\n.status-bar_panel-value {\\r\\n  font-weight: bold;\\r\\n  margin-left: 5px;\\r\\n  margin-right: 2px;\\r\\n}\\r\\n\\r\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInByb2plY3RzL25ncjItbWFya2Rvd24vc3JjL2xpYi9zdGF0dXMtYmFyL3N0YXR1cy1iYXIuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLGFBQWE7RUFDYixrQ0FBa0M7RUFDbEMsZUFBZTtFQUNmLHlCQUF5QjtFQUN6QixZQUFZO0VBQ1osWUFBWTtBQUNkOztBQUVBO0VBQ0UsaUJBQWlCO0FBQ25COztBQUVBO0VBQ0UsZUFBZTtBQUNqQjs7QUFFQTtFQUNFLGNBQWM7QUFDaEI7O0FBRUE7RUFDRSxjQUFjO0FBQ2hCOztBQUVBO0VBQ0UsY0FBYztBQUNoQjs7QUFFQTtFQUNFLGVBQWU7QUFDakI7O0FBRUE7QUFDQTs7QUFFQTtFQUNFLGlCQUFpQjtFQUNqQixnQkFBZ0I7RUFDaEIsaUJBQWlCO0FBQ25CIiwiZmlsZSI6InByb2plY3RzL25ncjItbWFya2Rvd24vc3JjL2xpYi9zdGF0dXMtYmFyL3N0YXR1cy1iYXIuY29tcG9uZW50LmNzcyIsInNvdXJjZXNDb250ZW50IjpbIi5zdGF0dXMtYmFyIHtcclxuICBkaXNwbGF5OiBmbGV4O1xyXG4gIC8qanVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOyovXHJcbiAgZm9udC1zaXplOiAxMHB4O1xyXG4gIGJhY2tncm91bmQtY29sb3I6ICMwMDdhY2M7XHJcbiAgY29sb3I6IHdoaXRlO1xyXG4gIGhlaWdodDogMTAwJTtcclxufVxyXG5cclxuLnN0YXR1cy1iYXJfcGFuZWwge1xyXG4gIGxpbmUtaGVpZ2h0OiAyMHB4O1xyXG59XHJcblxyXG4uc2ItZmlsZV9icm93c2VyIHtcclxuICBmbGV4OiAwIDAgMjAwcHg7XHJcbn1cclxuXHJcbi5zYi1lZGl0X2JveCB7XHJcbiAgZmxleDogMSAxIGF1dG87XHJcbn1cclxuXHJcbi5zYi1jb250cm9sX2JhciB7XHJcbiAgZmxleDogMCAwIDEwcHg7XHJcbn1cclxuXHJcbi5zYi1wcmV2aWV3X2JveCB7XHJcbiAgZmxleDogMSAxIGF1dG87XHJcbn1cclxuXHJcbi5zYi1tZW51IHtcclxuICBmbGV4OiAwIDAgMjgwcHg7XHJcbn1cclxuXHJcbi5zdGF0dXMtYmFyX3BhbmVsLW5hbWUge1xyXG59XHJcblxyXG4uc3RhdHVzLWJhcl9wYW5lbC12YWx1ZSB7XHJcbiAgZm9udC13ZWlnaHQ6IGJvbGQ7XHJcbiAgbWFyZ2luLWxlZnQ6IDVweDtcclxuICBtYXJnaW4tcmlnaHQ6IDJweDtcclxufVxyXG4iXX0= */\"","module.exports = \"<footer class=\\\"status-bar\\\"\\r\\n>\\r\\n  <div class=\\\"status-bar_panel sb-file_browser\\\"\\r\\n  >\\r\\n    <span class=\\\"status-bar_panel-name\\\">File</span>\\r\\n    <span><span class=\\\"status-bar_panel-value\\\">{{ fileInfo && fileInfo.title }}</span></span>\\r\\n  </div>\\r\\n\\r\\n  <div class=\\\"status-bar_panel sb-edit_box\\\"\\r\\n  >\\r\\n    <span class=\\\"status-bar_panel-name\\\">Markdown</span>\\r\\n    <span><span class=\\\"status-bar_panel-value\\\">{{ mdInfo.bytes }}</span>bytes</span>\\r\\n    <span><span class=\\\"status-bar_panel-value\\\">{{ mdInfo.words }}</span>words</span>\\r\\n    <span><span class=\\\"status-bar_panel-value\\\">{{ mdInfo.lines }}</span>lines</span>\\r\\n  </div>\\r\\n\\r\\n  <div class=\\\"status-bar_panel sb-control_bar\\\">\\r\\n  </div>\\r\\n\\r\\n  <div class=\\\"status-bar_panel sb-preview_box\\\"\\r\\n  >\\r\\n    <span class=\\\"status-bar_panel-name\\\">HTML</span>\\r\\n    <span><span class=\\\"status-bar_panel-value\\\">{{ htmlInfo.characters }}</span>characters</span>\\r\\n    <span><span class=\\\"status-bar_panel-value\\\">{{ htmlInfo.words }}</span>words</span>\\r\\n    <span><span class=\\\"status-bar_panel-value\\\">{{ htmlInfo.paragraphs }}</span>paragraphs</span>\\r\\n  </div>\\r\\n\\r\\n  <div class=\\\"status-bar_panel sb-menu\\\">\\r\\n  </div>\\r\\n</footer>\\r\\n\"","import { Component, OnInit } from '@angular/core';\r\nimport {Ngr2MarkdownService} from '../service/ngr2-markdown.service';\r\nimport {filter} from 'rxjs/operators';\r\n\r\n@Component({\r\n  selector: 'nb-status-bar',\r\n  templateUrl: './status-bar.component.html',\r\n  styleUrls: ['./status-bar.component.css']\r\n})\r\nexport class StatusBarComponent implements OnInit {\r\n\r\n  mdInfo;\r\n  htmlInfo;\r\n  fileInfo;\r\n\r\n  constructor(private markdownService: Ngr2MarkdownService\r\n  ) {\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.markdownService.observeMarkdown()\r\n      .subscribe(allinfo => {\r\n        this.mdInfo   = allinfo.Markdown;\r\n        this.htmlInfo = allinfo.HTML;\r\n      });\r\n\r\n    this.markdownService.currentFile\r\n      .subscribe(info => this.fileInfo = info);\r\n  }\r\n\r\n}\r\n","import {Directive, ElementRef, HostListener, Input, OnDestroy, OnInit} from '@angular/core';\nimport {Ngr2MarkdownService} from '../service/ngr2-markdown.service';\nimport {SyncScroll} from '../core/syncScroll';\nimport {Subscription} from 'rxjs';\n\n@Directive({\n  selector: '[nbSyncScroll]'\n})\nexport class SyncScrollDirective implements OnInit, OnDestroy {\n\n  static mutexLock = false;\n\n  @HostListener('scroll', ['$event']) scroll = this.onScroll;\n\n  @Input() syncScrollInfo: SyncScroll;\n\n  private _el: HTMLElement;\n  private subscription: Subscription;\n\n  constructor(private markdownService: Ngr2MarkdownService,\n              el: ElementRef\n  ) {\n    this._el = el.nativeElement;\n  }\n\n  ngOnInit(): void {\n    this.subscription = this.markdownService.syncScroll\n      .subscribe((value) => {\n        if (!value || value.headingInfo.el === this._el) { return; }\n\n        const curHeading = this.syncScrollInfo.getPairHeading(value.headingInfo.pairId);\n        const deltaHeight = value.scrollTop - value.headingInfo.offsetTop;\n        this._el.scrollTop = curHeading.headingInfo.offsetTop + (curHeading.headingInfo.height / value.headingInfo.height) * deltaHeight;\n      });\n  }\n\n  ngOnDestroy(): void {\n    this.subscription.unsubscribe();\n  }\n\n  onScroll(event: Event) {\n    if (SyncScrollDirective.mutexLock) {\n      SyncScrollDirective.mutexLock = false;\n    } else {\n    this.markdownService.syncScroll.next(this.syncScrollInfo.currentHeading());\n      SyncScrollDirective.mutexLock = true;\n    }\n  }\n}\n","module.exports = \"a {\\r\\n  color: gray;\\r\\n  text-decoration: none;\\r\\n}\\r\\n\\r\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInByb2plY3RzL25ncjItbWFya2Rvd24vc3JjL2xpYi90b29sLWJhci90b29sLWJhci5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsV0FBVztFQUNYLHFCQUFxQjtBQUN2QiIsImZpbGUiOiJwcm9qZWN0cy9uZ3IyLW1hcmtkb3duL3NyYy9saWIvdG9vbC1iYXIvdG9vbC1iYXIuY29tcG9uZW50LmNzcyIsInNvdXJjZXNDb250ZW50IjpbImEge1xyXG4gIGNvbG9yOiBncmF5O1xyXG4gIHRleHQtZGVjb3JhdGlvbjogbm9uZTtcclxufVxyXG4iXX0= */\"","module.exports = \"<a [download]=\\\"title + '.md'\\\"\\r\\n   [href]=\\\"mdHref | safe:'url'\\\"\\r\\n>\\r\\n  MD\\r\\n</a>\\r\\n<a [download]=\\\"title + '.html'\\\"\\r\\n   [href]=\\\"htmlHref | safe:'url'\\\"\\r\\n>\\r\\n  HTML\\r\\n</a>\\r\\n\"","import {Component, OnDestroy, OnInit} from '@angular/core';\r\nimport {Ngr2MarkdownService} from '../service/ngr2-markdown.service';\r\nimport {Subscription} from 'rxjs';\r\nimport {FileOperatorImpl} from '../core/fileOperator';\r\n\r\n@Component({\r\n  selector: 'nb-tool-bar',\r\n  templateUrl: './tool-bar.component.html',\r\n  styleUrls: ['./tool-bar.component.css']\r\n})\r\nexport class ToolBarComponent implements OnInit, OnDestroy {\r\n\r\n  mdHref: string;\r\n  htmlHref: string;\r\n  title: string;\r\n  titleSubscribe: Subscription;\r\n  hrefSubscribe: Subscription;\r\n  constructor(\r\n    private markdownService: Ngr2MarkdownService\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    this.titleSubscribe = this.markdownService.TOCInfo\r\n      .subscribe(value => this.title = value.content);\r\n    let MdFileOperator: FileOperatorImpl;\r\n    let HTMLFileOperator: FileOperatorImpl;\r\n    this.hrefSubscribe = this.markdownService.currentContent\r\n      .subscribe(value => {\r\n        if (MdFileOperator) { MdFileOperator.revokeDataURLSync(); }\r\n        if (HTMLFileOperator) { HTMLFileOperator.revokeDataURLSync(); }\r\n        MdFileOperator = this.markdownService.currentContentToDataUrl('markdown');\r\n        HTMLFileOperator = this.markdownService.currentContentToDataUrl('html');\r\n        this.mdHref = MdFileOperator.result;\r\n        this.htmlHref = HTMLFileOperator.result;\r\n      });\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.titleSubscribe.unsubscribe();\r\n    this.hrefSubscribe.unsubscribe();\r\n  }\r\n}\r\n","import {\n  Directive, HostListener, TemplateRef,\n  ViewContainerRef\n} from '@angular/core';\nimport {TreeNodeComponent} from '../tree-node/tree-node.component';\n\n\n@Directive({\n  selector: '[nbTreeNodeOutlet]'\n})\nexport class TreeNodeOutletDirective {\n\n  constructor(public viewContainer: ViewContainerRef\n  ) {\n  }\n}\n\n@Directive({\n  selector: '[nbTreeNodeDef]'\n})\nexport class TreeNodeDefDirective {\n\n  constructor(\n    public templateRef: TemplateRef<any>\n  ) {\n    // view.createEmbeddedView(template);\n  }\n}\n","import {Directive, EventEmitter, HostListener, Input, Output} from '@angular/core';\nimport {TreeNodeComponent} from '../tree-node/tree-node.component';\n\n@Directive({\n  selector: '[nbTreeNodeToggle]'\n})\nexport class TreeNodeToggleDirective {\n\n  @HostListener('dblclick', ['$event'])\n  toggle(event: Event) {\n    this.treeNode.isExpanded = !this.treeNode.isExpanded;\n    event.preventDefault();\n    this.callbackFn.emit(this.treeNode);\n  }\n\n  @Output() callbackFn = new EventEmitter<TreeNodeComponent>();\n\n  constructor(private treeNode: TreeNodeComponent) {\n  }\n\n}\n","module.exports = \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJwcm9qZWN0cy9uZ3IyLW1hcmtkb3duL3NyYy9saWIvdHJlZS90cmVlLW5vZGUvdHJlZS1ub2RlLmNvbXBvbmVudC5jc3MifQ== */\"","module.exports = \"<ng-content></ng-content>\\n\"","import {\n  AfterContentInit,\n  Component,\n  ContentChild,\n  Input,\n  IterableDiffer,\n  IterableDiffers,\n  OnInit\n} from '@angular/core';\nimport {TreeableNode, TreeNode} from '../../core/tree/tree';\nimport {TreeNodeOutletDirective} from '../tree-node-directive/tree-node-def.directive';\nimport {TreeComponent, TreeControl} from '../tree/tree.component';\n\n@Component({\n  selector: 'nb-tree-node',\n  templateUrl: './tree-node.component.html',\n  styleUrls: ['./tree-node.component.css']\n})\nexport class TreeNodeComponent implements OnInit, AfterContentInit {\n\n  private _dataDiffer: IterableDiffer<TreeNode<TreeableNode>>;\n\n  @Input()\n  get isExpanded() { return this._isExpanded; }\n  set isExpanded(value: boolean) {\n    console.log('isExpanded');\n    this._isExpanded = value;\n    if (this.isExpanded) {\n      this.updateChildrenNodes();\n    } else {\n      this.outlet.viewContainer.clear();\n      this._dataDiffer.diff([]);\n    }\n  }\n  private _isExpanded: boolean;\n\n  /**\n   * 树节点的数据\n   */\n  get data(): TreeNode<TreeableNode> { return this._data; }\n  set data(value: TreeNode<TreeableNode>) {\n    this._data = value;\n  }\n  private _data: TreeNode<TreeableNode>;\n\n  @ContentChild(TreeNodeOutletDirective) outlet: TreeNodeOutletDirective;\n\n  constructor(private _tree: TreeComponent,\n              private _differs: IterableDiffers\n  ) {\n    TreeControl.mostRecentTreeNode = this;\n    this._dataDiffer = this._differs.find([]).create();\n  }\n\n  ngOnInit() {\n    // this._tree.renderNodeChanges(this.data.children, this._dataDiffer, this.outlet.viewContainer);\n  }\n\n  ngAfterContentInit(): void {\n  }\n\n  updateChildrenNodes() {\n    this._tree.renderNodeChanges(this.data.children, this._dataDiffer, this.outlet.viewContainer);\n  }\n}\n","module.exports = \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJwcm9qZWN0cy9uZ3IyLW1hcmtkb3duL3NyYy9saWIvdHJlZS90cmVlL3RyZWUuY29tcG9uZW50LmNzcyJ9 */\"","module.exports = \"<ul>\\n  <ng-container nbTreeNodeOutlet></ng-container>\\n</ul>\\n\"","import {\n  Component,\n  ContentChildren,\n  Input, IterableDiffer, IterableDiffers,\n  OnInit, QueryList,\n  ViewChild, ViewContainerRef\n} from '@angular/core';\nimport {Tree, TreeableNode, TreeNode} from '../../core/tree/tree';\nimport {Article} from '../../file-browser/file-browser.component';\nimport {TreeNodeDefDirective, TreeNodeOutletDirective} from '../tree-node-directive/tree-node-def.directive';\nimport {TreeNodeComponent} from '../tree-node/tree-node.component';\n\n@Component({\n  selector: 'nb-tree',\n  templateUrl: './tree.component.html',\n  styleUrls: ['./tree.component.css']\n})\nexport class TreeComponent implements OnInit {\n\n  @ViewChild(TreeNodeOutletDirective) outlet: TreeNodeOutletDirective;\n  @ContentChildren(TreeNodeDefDirective) def: QueryList<TreeNodeDefDirective>;\n\n  private _ds: Tree<Article>;\n  private _dataDiffer: IterableDiffer<TreeNode<TreeableNode>>;\n\n  @Input()\n  set dataSource(ds: Tree<Article>) {\n    if (!ds) { return; }\n    this._ds = ds;\n    this.renderNodeChanges(this._ds.rootNode.children, this._dataDiffer, this.outlet.viewContainer);\n  }\n  get dataSource() {\n    return this._ds;\n  }\n\n  constructor(private differs: IterableDiffers) {\n    this._dataDiffer = differs.find([])\n      .create((index, item) => item);\n  }\n\n  ngOnInit() {\n  }\n\n  renderNodeChanges(data: Array<TreeNode<TreeableNode>>,\n                    dataDiffer: IterableDiffer<TreeNode<TreeableNode>> = this._dataDiffer,\n                    viewContainer: ViewContainerRef = this.outlet.viewContainer) {\n    const changes = dataDiffer.diff(data);\n    if (!changes) { return; }\n\n    changes.forEachOperation((record, previousIndex, currentIndex) => {\n      // console.log(record.previousIndex, previousIndex, record.currentIndex, currentIndex);\n      if (record.previousIndex === null) {\n        viewContainer.createEmbeddedView(this.def.first.templateRef, record.item, currentIndex);\n        TreeControl.mostRecentTreeNode.data = record.item;\n      } else if (currentIndex === null) {\n        viewContainer.remove(previousIndex);\n      } else {\n        const view = viewContainer.get(previousIndex);\n        viewContainer.move(view, currentIndex);\n      }\n    });\n  }\n}\n\nexport class TreeControl {\n  static mostRecentTreeNode: TreeNodeComponent | null = null;\n}\n","// @dynamic\r\nexport class TextParser {\r\n\r\n  private static _DIV = document.createElement('DIV');\r\n  static WORDS = new RegExp(/([a-zA-Z]+)|([\\u4e00-\\u9fa5])/g);\r\n\r\n  private static parse(text: string = ''): {\r\n    text: string,\r\n    words: number,\r\n    bytes: number,\r\n    lines: number\r\n  } {\r\n    const words = (text.match(TextParser.WORDS) || []).length;\r\n    let bytes = 0;\r\n    let lines = 0;\r\n    for (let i = 0; i < text.length; i++) {\r\n      if (text.charCodeAt(i) & 0xff00) {\r\n        bytes++;\r\n      } else if (text.charAt(i) === '\\n') {\r\n        lines++;\r\n      }\r\n      bytes++;\r\n    }\r\n    return {\r\n      text: text,\r\n      words: words,\r\n      bytes: bytes,\r\n      lines: lines\r\n    };\r\n  }\r\n\r\n  static parseMD(markdown: string): any {\r\n    return this.parse(markdown);\r\n  }\r\n\r\n  static parseHTML(html: string): any {\r\n    TextParser._DIV.innerHTML = html;\r\n\r\n    const result = this.parse(TextParser._DIV.textContent);\r\n    return {\r\n      text: html,\r\n      characters: result.bytes,\r\n      words: result.words,\r\n      paragraphs: result.lines\r\n    };\r\n  }\r\n}\r\n","function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"./src/$$_lazy_route_resource lazy recursive\";","module.exports = \".main-container {\\r\\n  display: -ms-flexbox;\\r\\n  display: flex;\\r\\n  -ms-flex-direction: column;\\r\\n      flex-direction: column;\\r\\n  height: 100vh;\\r\\n}\\r\\n\\r\\n.toolbar {\\r\\n  display: -ms-flexbox;\\r\\n  display: flex;\\r\\n  -ms-flex-align: center;\\r\\n      align-items: center;\\r\\n  -ms-flex: 0 0 40px;\\r\\n      flex: 0 0 40px;\\r\\n  box-sizing: border-box;\\r\\n  padding: 5px;\\r\\n  background-color: lightgray;\\r\\n}\\r\\n\\r\\n.toolbar button {\\r\\n}\\r\\n\\r\\n.markdown {\\r\\n  -ms-flex: 1;\\r\\n      flex: 1;\\r\\n}\\r\\n\\r\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvYXBwLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxvQkFBYTtFQUFiLGFBQWE7RUFDYiwwQkFBc0I7TUFBdEIsc0JBQXNCO0VBQ3RCLGFBQWE7QUFDZjs7QUFFQTtFQUNFLG9CQUFhO0VBQWIsYUFBYTtFQUNiLHNCQUFtQjtNQUFuQixtQkFBbUI7RUFDbkIsa0JBQWM7TUFBZCxjQUFjO0VBQ2Qsc0JBQXNCO0VBQ3RCLFlBQVk7RUFDWiwyQkFBMkI7QUFDN0I7O0FBRUE7QUFDQTs7QUFFQTtFQUNFLFdBQU87TUFBUCxPQUFPO0FBQ1QiLCJmaWxlIjoic3JjL2FwcC9hcHAuY29tcG9uZW50LmNzcyIsInNvdXJjZXNDb250ZW50IjpbIi5tYWluLWNvbnRhaW5lciB7XHJcbiAgZGlzcGxheTogZmxleDtcclxuICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xyXG4gIGhlaWdodDogMTAwdmg7XHJcbn1cclxuXHJcbi50b29sYmFyIHtcclxuICBkaXNwbGF5OiBmbGV4O1xyXG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XHJcbiAgZmxleDogMCAwIDQwcHg7XHJcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcclxuICBwYWRkaW5nOiA1cHg7XHJcbiAgYmFja2dyb3VuZC1jb2xvcjogbGlnaHRncmF5O1xyXG59XHJcblxyXG4udG9vbGJhciBidXR0b24ge1xyXG59XHJcblxyXG4ubWFya2Rvd24ge1xyXG4gIGZsZXg6IDE7XHJcbn1cclxuIl19 */\"","module.exports = \"<!--The content below is only a placeholder and can be replaced.-->\\r\\n<div class=\\\"main-container\\\">\\r\\n  <nb-ngr2-markdown\\r\\n    [options]=\\\"{TOC: true, toolBar: true, direction: 'left', bodyClassName: 'markdown-body', height: 'calc(100vh)', themeColor: '#3f51a5'}\\\"\\r\\n    class=\\\"markdown\\\"\\r\\n  ></nb-ngr2-markdown>\\r\\n</div>\\r\\n\"","import {AfterViewChecked, AfterViewInit, Component} from '@angular/core';\r\nimport {Ngr2MarkdownService} from '../../projects/ngr2-markdown/src/lib/service/ngr2-markdown.service';\r\nimport {Tree} from '../../projects/ngr2-markdown/src/lib/core/tree/tree';\r\n\r\n@Component({\r\n  selector: 'app-root',\r\n  templateUrl: './app.component.html',\r\n  styleUrls: ['./app.component.css']\r\n})\r\nexport class AppComponent implements AfterViewInit, AfterViewChecked {\r\n  title = 'ngr2-markdown-example';\r\n  /*tslint:disable*/\r\n  exampleText1 = `## page类构造函数\r\n\\`\\`\\`java\r\npublic Page(int pageId, String pageTitle, String pageAuthor, String pageContent, Timestamp createTime, Timestamp lastModifiedTime) {\r\n        this.pageId = pageId;\r\n        this.pageTitle = pageTitle;\r\n        this.pageAuthor = pageAuthor;\r\n        this.pageContent = pageContent;\r\n        this.createTime = createTime;\r\n        this.lastModifiedTime = lastModifiedTime;\r\n    }\r\n\\`\\`\\`\r\n### test3\r\n### test4\r\n## Controller层\r\n\\`\\`\\`java\r\n/**\r\n     * 获取指定页面完整信息\r\n     * @author Ce\r\n     * @date 2018/4/25 17:02\r\n     * @param [pageId]\r\n     * @return com.alibaba.fastjson.JSONObject\r\n     */\r\n    public Page pageInfo (int pageId) {\r\n\r\n        Object[] params = new Object[1];\r\n        params[0] = pageId;\r\n        List list = queryRepository.executeQuery(\"select new Page(pageId, pageTitle, pageAuthor, pageContent, createTime, lastModifiedTime) from Page where pageId=?0\", params);\r\n\r\n        if (list.size() > 1) {\r\n            try {\r\n                throw new Exception(\"pageId对应了多个page\");\r\n            } catch (Exception e) {\r\n                e.printStackTrace();\r\n            }\r\n        }\r\n        return (Page) list.get(0);\r\n    }\r\n\\`\\`\\`\r\n### test5\r\n可以看到在Page类的构造函数中有Timestamp类型的两个参数\\`createTime\\`和\\`lastModifiedTime\\`而导致爆出以下错误的原因是hibernate没有找到对应的构造函数.\r\n\\`\\`\\`\r\ncause=org.hibernate.PropertyNotFoundException: no appropriate constructor in class: cn.freedoe.entity.Page\r\n\\`\\`\\`\r\n所以应该是hibernate在mysql的timestamp类型和java的Timestamp类型转换的问题.\r\n但是通过Criteria添加条件,是可以成功执行查询的,所以问题范围缩小到HQL语句的DTO查询对Timestamp类型的转换识别\r\n`;\r\n  /*tslint:enable*/\r\n  content = null;\r\n\r\n  constructor(\r\n    private markdownService: Ngr2MarkdownService\r\n  ) {\r\n    // markdownService.reinitialization(this.exampleText1);\r\n  }\r\n\r\n  ngAfterViewInit(): void {\r\n  }\r\n\r\n  ngAfterViewChecked(): void {\r\n  }\r\n}\r\n","import { BrowserModule } from '@angular/platform-browser';\r\nimport { BrowserAnimationsModule } from '@angular/platform-browser/animations';\r\nimport { NgModule } from '@angular/core';\r\n\r\nimport { AppComponent } from './app.component';\r\nimport {Ngr2MarkdownModule} from '../../projects/ngr2-markdown/src/lib/ngr2-markdown.module';\r\n// import {Ngr2MarkdownModule} from 'ngr2-markdown';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    AppComponent\r\n  ],\r\n  imports: [\r\n    BrowserModule,\r\n    BrowserAnimationsModule,\r\n    Ngr2MarkdownModule\r\n  ],\r\n  providers: [],\r\n  bootstrap: [AppComponent]\r\n})\r\nexport class AppModule { }\r\n","// This file can be replaced during build by using the `fileReplacements` array.\r\n// `ng build --prod` replaces `environment.ts` with `environment.prod.ts`.\r\n// The list of file replacements can be found in `angular.json`.\r\n\r\nexport const environment = {\r\n  production: false\r\n};\r\n\r\n/*\r\n * For easier debugging in development mode, you can import the following file\r\n * to ignore zone related error stack frames such as `zone.run`, `zoneDelegate.invokeTask`.\r\n *\r\n * This import should be commented out in production mode because it will have a negative impact\r\n * on performance if an error is thrown.\r\n */\r\n// import 'zone.js/dist/zone-error';  // Included with Angular CLI.\r\n","import { enableProdMode } from '@angular/core';\r\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\r\n\r\nimport { AppModule } from './app/app.module';\r\nimport { environment } from './environments/environment';\r\n\r\nif (environment.production) {\r\n  enableProdMode();\r\n}\r\n\r\nplatformBrowserDynamic().bootstrapModule(AppModule)\r\n  .catch(err => console.error(err));\r\n"],"sourceRoot":""}